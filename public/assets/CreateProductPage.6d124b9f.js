import{x as R,r as k,A as f,B as g,i as me,s as X,U as fe,E as K,b4 as F,ae as ge,aM as _e,D as O,bt as Z,y as be,z as ye,ba as he,aF as Se,S as xe,o as B,c as T,a as o,e as i,w as N,F as Ce,d as qe,g as we,m as ee,t as z,Q as $,_ as Pe,f as De,j as Ne,l as ke,X as ze,h as Y,ac as Ue,n as Ve,v as Ie,ab as $e,p as Be,q as H,N as Qe,C as Ae}from"./index.fad208ab.js";import{Q as Te}from"./QSlideTransition.5153393c.js";import{u as Ee,a as Fe,b as je,c as Oe}from"./use-panel.0a93bed0.js";import{u as Re}from"./use-render-cache.3aae9b27.js";import{Q as E,a as te}from"./QCarousel.c391e3cc.js";import{Q as Ke}from"./QCardActions.5ca72f30.js";import{u as ae}from"./productAttributes.e2855146.js";import{_ as Me}from"./SuccessDialog.c2cdd5d5.js";import{C as Le,_ as We}from"./CreateProductStepTwo.757489a9.js";import{Q as J}from"./QSeparator.62c942f7.js";import"./touch.9135741d.js";import"./selection.27bfdd36.js";import"./QChip.208e8a8e.js";import"./QInput.41d87495.js";import"./use-id.d7e26954.js";import"./private.use-form.81163b54.js";import"./format.8ac60962.js";import"./QSelect.c34545e2.js";import"./QItemLabel.2bb5d272.js";import"./QMenu.02e0ca6a.js";var re=R({name:"StepHeader",props:{stepper:{},step:{},goToPanel:Function},setup(e,{attrs:b}){const{proxy:{$q:m}}=K(),p=k(null),n=f(()=>e.stepper.modelValue===e.step.name),h=f(()=>{const r=e.step.disable;return r===!0||r===""}),q=f(()=>{const r=e.step.error;return r===!0||r===""}),y=f(()=>{const r=e.step.done;return h.value===!1&&(r===!0||r==="")}),C=f(()=>{const r=e.step.headerNav,d=r===!0||r===""||r===void 0;return h.value===!1&&e.stepper.headerNav&&d}),_=f(()=>e.step.prefix&&(n.value===!1||e.stepper.activeIcon==="none")&&(q.value===!1||e.stepper.errorIcon==="none")&&(y.value===!1||e.stepper.doneIcon==="none")),c=f(()=>{const r=e.step.icon||e.stepper.inactiveIcon;if(n.value===!0){const d=e.step.activeIcon||e.stepper.activeIcon;return d==="none"?r:d||m.iconSet.stepper.active}if(q.value===!0){const d=e.step.errorIcon||e.stepper.errorIcon;return d==="none"?r:d||m.iconSet.stepper.error}if(h.value===!1&&y.value===!0){const d=e.step.doneIcon||e.stepper.doneIcon;return d==="none"?r:d||m.iconSet.stepper.done}return r}),a=f(()=>{const r=q.value===!0?e.step.errorColor||e.stepper.errorColor:void 0;if(n.value===!0){const d=e.step.activeColor||e.stepper.activeColor||e.step.color;return d!==void 0?d:r}return r!==void 0?r:h.value===!1&&y.value===!0?e.step.doneColor||e.stepper.doneColor||e.step.color||e.stepper.inactiveColor:e.step.color||e.stepper.inactiveColor}),t=f(()=>"q-stepper__tab col-grow flex items-center no-wrap relative-position"+(a.value!==void 0?` text-${a.value}`:"")+(q.value===!0?" q-stepper__tab--error q-stepper__tab--error-with-"+(_.value===!0?"prefix":"icon"):"")+(n.value===!0?" q-stepper__tab--active":"")+(y.value===!0?" q-stepper__tab--done":"")+(C.value===!0?" q-stepper__tab--navigation q-focusable q-hoverable":"")+(h.value===!0?" q-stepper__tab--disabled":"")),l=f(()=>e.stepper.headerNav!==!0?!1:C.value);function U(){p.value!==null&&p.value.focus(),n.value===!1&&e.goToPanel(e.step.name)}function s(r){r.keyCode===13&&n.value===!1&&e.goToPanel(e.step.name)}return()=>{const r={class:t.value};C.value===!0&&(r.onClick=U,r.onKeyup=s,Object.assign(r,h.value===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:b.tabindex||0}));const d=[g("div",{class:"q-focus-helper",tabindex:-1,ref:p}),g("div",{class:"q-stepper__dot row flex-center q-stepper__line relative-position"},[g("span",{class:"row flex-center"},[_.value===!0?e.step.prefix:g(me,{name:c.value})])])];if(e.step.title!==void 0&&e.step.title!==null){const V=[g("div",{class:"q-stepper__title"},e.step.title)];e.step.caption!==void 0&&e.step.caption!==null&&V.push(g("div",{class:"q-stepper__caption"},e.step.caption)),d.push(g("div",{class:"q-stepper__label q-stepper__line relative-position"},V))}return X(g("div",r,d),[[fe,l.value]])}}});function se(e){return g("div",{class:"q-stepper__step-content"},[g("div",{class:"q-stepper__step-inner"},O(e.default))])}const G={setup(e,{slots:b}){return()=>se(b)}};var j=R({name:"QStep",props:{...Ee,icon:String,color:String,title:{type:String,required:!0},caption:String,prefix:[String,Number],doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String,headerNav:{type:Boolean,default:!0},done:Boolean,error:Boolean,onScroll:[Function,Array]},setup(e,{slots:b,emit:m}){const{proxy:{$q:p}}=K(),n=ge(Z,F);if(n===F)return console.error("QStep needs to be a child of QStepper"),F;const{getCache:h}=Re(),q=k(null),y=f(()=>n.value.modelValue===e.name),C=f(()=>p.platform.is.ios!==!0&&p.platform.is.chrome===!0||y.value!==!0||n.value.vertical!==!0?{}:{onScroll(a){const{target:t}=a;t.scrollTop>0&&(t.scrollTop=0),e.onScroll!==void 0&&m("scroll",a)}}),_=f(()=>typeof e.name=="string"||typeof e.name=="number"?e.name:String(e.name));function c(){const a=n.value.vertical;return a===!0&&n.value.keepAlive===!0?g(_e,n.value.keepAliveProps.value,y.value===!0?[g(n.value.needsUniqueKeepAliveWrapper.value===!0?h(_.value,()=>({...G,name:_.value})):G,{key:_.value},b.default)]:void 0):a!==!0||y.value===!0?se(b):void 0}return()=>g("div",{ref:q,class:"q-stepper__step",role:"tabpanel",...C.value},n.value.vertical===!0?[g(re,{stepper:n.value,step:e,goToPanel:n.value.goToPanel}),n.value.animated===!0?g(Te,c):c()]:[c()])}});const Ye=/(-\w)/g;function He(e){const b={};for(const m in e){const p=m.replace(Ye,n=>n[1].toUpperCase());b[p]=e[m]}return b}var Je=R({name:"QStepper",props:{...be,...Fe,flat:Boolean,bordered:Boolean,alternativeLabels:Boolean,headerNav:Boolean,contracted:Boolean,headerClass:String,inactiveColor:String,inactiveIcon:String,doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String},emits:je,setup(e,{slots:b}){const m=K(),p=ye(e,m.proxy.$q),{updatePanelsList:n,isValidPanelName:h,updatePanelIndex:q,getPanelContent:y,getPanels:C,panelDirectives:_,goToPanel:c,keepAliveProps:a,needsUniqueKeepAliveWrapper:t}=Oe();he(Z,f(()=>({goToPanel:c,keepAliveProps:a,needsUniqueKeepAliveWrapper:t,...e})));const l=f(()=>`q-stepper q-stepper--${e.vertical===!0?"vertical":"horizontal"}`+(e.flat===!0?" q-stepper--flat":"")+(e.bordered===!0?" q-stepper--bordered":"")+(p.value===!0?" q-stepper--dark q-dark":"")),U=f(()=>`q-stepper__header row items-stretch justify-between q-stepper__header--${e.alternativeLabels===!0?"alternative":"standard"}-labels`+(e.flat===!1||e.bordered===!0?" q-stepper__header--border":"")+(e.contracted===!0?" q-stepper__header--contracted":"")+(e.headerClass!==void 0?` ${e.headerClass}`:""));function s(){const r=O(b.message,[]);if(e.vertical===!0){h(e.modelValue)&&q();const d=g("div",{class:"q-stepper__content"},O(b.default));return r===void 0?[d]:r.concat(d)}return[g("div",{class:U.value},C().map(d=>{const V=He(d.props);return g(re,{key:V.name,stepper:e,step:V,goToPanel:c})})),r,xe("div",{class:"q-stepper__content q-panel-parent"},y(),"cont",e.swipeable,()=>_.value)]}return()=>(n(b),g("div",{class:l.value},Se(b.navigation,s())))}});const Ge={class:"q-pa-sm"},Xe={class:"bg-grey-1 rounded-lg p-3 q-mb-sm"},Ze={key:0,class:"q-mb-sm"},et=["src"],tt={class:"q-mb-sm"},at={class:"text-h6"},rt={class:"text-h5 text-primary"},st={class:"q-mb-sm text-body1"},lt={class:"q-mb-sm"},ot={class:"grid grid-cols-2 gap-2"},nt={class:"flex items-center"},it={class:"text-body2 font-medium"},ut={class:"flex items-center"},dt={class:"text-body2 font-medium"},ct={class:"flex items-center"},pt={class:"text-body2 font-medium"},vt={class:"flex items-center"},mt={class:"text-body2 font-medium"},ft={class:"flex items-center"},gt={class:"text-body2 font-medium"},_t={class:"flex justify-between q-mt-md"},bt={__name:"CreateProductStepThree",props:{productData:{type:Object,required:!0},isEditMode:{type:Boolean,default:!1},isSubmitting:{type:Boolean,default:!1}},emits:["back","submit"],setup(e,{emit:b}){const m=e,p=ae(),n=k(0),h=a=>{if(!a)return"Not selected";const t=p.categories.find(l=>l.id===a);return t?t.name:"Not selected"},q=a=>{if(!a)return"Not selected";const t=p.brands.find(l=>l.id===a);return t?t.name:"Not selected"},y=a=>{if(!a)return"Not selected";const t=p.styles.find(l=>l.id===a);return t?t.name:"Not selected"},C=a=>{if(!a)return"Not selected";const t=p.colors.find(l=>l.id===a);return t?t.name:"Not selected"},_=a=>{if(!a)return"Not selected";let t;return m.productData.size_type==="letter"?t=p.letterSizes.find(l=>l.id===a):m.productData.size_type==="number"?t=p.numberSizes.find(l=>l.id===a):m.productData.size_type==="waist"&&(t=p.waistSizes.find(l=>l.id===a)),t?t.display_name:"Not selected"},c=(a,t)=>a?a.length<=t?a:a.substring(0,t)+"...":"";return(a,t)=>(B(),T("div",Ge,[t[10]||(t[10]=o("h3",{class:"text-h6 q-mb-sm"},"Review Your Product",-1)),o("div",Xe,[e.productData.imagePreviewUrls&&e.productData.imagePreviewUrls.length?(B(),T("div",Ze,[i(te,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=l=>n.value=l),"transition-prev":"slide-right","transition-next":"slide-left",swipeable:"",animated:"","control-color":"primary",navigation:"",padding:"",arrows:"",height:"200px",class:"bg-white rounded-lg shadow-1"},{default:N(()=>[(B(!0),T(Ce,null,qe(e.productData.imagePreviewUrls,(l,U)=>(B(),we(E,{key:U,name:U,class:"column no-wrap flex-center"},{default:N(()=>[o("img",{src:l.url,class:"max-h-full object-contain"},null,8,et)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])):ee("",!0),o("div",tt,[o("div",at,z(e.productData.title),1),o("div",rt,"$"+z(e.productData.price)+" / day",1)]),i(J,{class:"q-my-sm"}),t[9]||(t[9]=o("div",{class:"text-subtitle1 font-bold q-mb-xs"},"Description",-1)),o("p",st,z(c(e.productData.description,150)),1),i(J,{class:"q-my-sm"}),o("div",lt,[t[8]||(t[8]=o("div",{class:"text-subtitle1 font-bold q-mb-xs"},"Product Specifications",-1)),o("div",ot,[o("div",nt,[t[3]||(t[3]=o("div",{class:"text-grey-7 text-caption q-mr-xs"},"Category:",-1)),o("div",it,z(h(e.productData.category_id)),1)]),o("div",ut,[t[4]||(t[4]=o("div",{class:"text-grey-7 text-caption q-mr-xs"},"Brand:",-1)),o("div",dt,z(q(e.productData.brand_id)),1)]),o("div",ct,[t[5]||(t[5]=o("div",{class:"text-grey-7 text-caption q-mr-xs"},"Style:",-1)),o("div",pt,z(y(e.productData.style_id)),1)]),o("div",vt,[t[6]||(t[6]=o("div",{class:"text-grey-7 text-caption q-mr-xs"},"Color:",-1)),o("div",mt,z(C(e.productData.color_id)),1)]),o("div",ft,[t[7]||(t[7]=o("div",{class:"text-grey-7 text-caption q-mr-xs"},"Size:",-1)),o("div",gt,z(_(e.productData.size_id)),1)])])])]),o("div",_t,[i($,{outline:"",color:"grey",label:"Go Back",onClick:t[1]||(t[1]=l=>a.$emit("back")),"no-caps":""}),i($,{color:"primary",label:e.isEditMode?"Update Product":"Post Product",onClick:t[2]||(t[2]=l=>a.$emit("submit")),loading:e.isSubmitting,"no-caps":""},null,8,["label","loading"])])]))}};const yt={class:"max-w-3xl mx-auto p-2 mb-8 relative"},ht={key:0,class:"absolute inset-0 bg-white bg-opacity-75 z-50 flex items-center justify-center",style:{cursor:"not-allowed"}},St={class:"text-xl font-semibold mb-4 mt-0"},xt={class:"flex justify-end q-mt-sm"},Ct={class:"flex justify-between q-mt-sm"},qt={__name:"CreateProductPage",setup(e){const b=De(),m=$e(),p=ae(),n=Ne(),h=k(!1),q=k(!1),y=k(!1),C=k(!1),_=k({}),c=k(1),a=k(null),t=k(null),l=f(()=>!!m.params.id),U=f(()=>l.value?"Edit Product":"Create New Product"),s=k({title:"",description:"",category_id:null,brand_id:null,style_id:null,color_id:null,price:null,size_type:null,size_id:null,media:null,imagePreviewUrls:[],images:[]}),r=f(()=>s.value.title&&s.value.title.length>=3&&s.value.description&&s.value.description.length>=10&&s.value.price&&s.value.price>0&&s.value.imagePreviewUrls&&s.value.imagePreviewUrls.length>0),d=f(()=>s.value.category_id&&s.value.brand_id&&s.value.style_id&&s.value.color_id&&s.value.size_type&&s.value.size_id),V=()=>{c.value++},M=()=>{c.value--},le=v=>{s.value={...s.value,...v}},oe=v=>{s.value={...s.value,...v}},L=v=>{_.value={..._.value,...v}},ne=v=>{v&&v.preventDefault(),y.value=!0},ie=async()=>{y.value=!1,await ce()},ue=()=>{s.value={title:"",description:"",category_id:null,brand_id:null,style_id:null,color_id:null,price:null,size_type:null,size_id:null,media:null,imagePreviewUrls:[],images:[]}},de=v=>{var w,Q,A,S,P,x;const u=v.data||v;s.value={title:u.title||"",description:u.description||"",category_id:((w=u.category)==null?void 0:w.id)||null,brand_id:((Q=u.brand)==null?void 0:Q.id)||null,style_id:((A=u.style)==null?void 0:A.id)||null,color_id:((S=u.color)==null?void 0:S.id)||null,price:parseFloat(u.price)||null,size_type:((P=u.size)==null?void 0:P.type)||null,size_id:((x=u.size)==null?void 0:x.id)||null,media:null,imagePreviewUrls:[],images:[]},u.media&&u.media.length>0&&(s.value.imagePreviewUrls=u.media.map(D=>({url:D.url,id:D.id,file:null,progress:100,order:D.order})))},ce=async()=>{var v,u,w,Q,A;try{if(!r.value||!d.value){r.value?d.value||(c.value=2):c.value=1;return}h.value=!0,_.value={};const S=new FormData;if(l.value&&m.params.id&&(S.append("_method","PUT"),S.append("id",m.params.id)),Object.keys(s.value).forEach(x=>{x!=="images"&&x!=="media"&&x!=="imagePreviewUrls"&&s.value[x]!==null&&S.append(x,s.value[x])}),s.value.imagePreviewUrls&&s.value.imagePreviewUrls.length>0){const x=s.value.imagePreviewUrls.map((D,I)=>{const W={id:D.id||null,order:I+1};return D.file instanceof File&&(W.file=D.file),W});S.append("media",JSON.stringify(x)),x.forEach((D,I)=>{D.file&&S.append(`media[${I}][file]`,D.file)})}else S.append("media",JSON.stringify([]));let P;if(l.value?P=await n.updateProduct(m.params.id,S):P=await n.createProduct(S),P&&(P.status===200||P.status==="success"||((v=P.data)==null?void 0:v.status)==="success")){C.value=!0;const x=((w=(u=P.data)==null?void 0:u.data)==null?void 0:w.id)||m.params.id;setTimeout(()=>{C.value=!1,b.push({name:"product-details",params:{id:x}})},1500)}}catch(S){if(console.error("Failed to save product:",S),(A=(Q=S.response)==null?void 0:Q.data)!=null&&A.errors){_.value=S.response.data.errors;const P=Object.keys(S.response.data.errors),x=["title","description","price","media"],D=["category_id","brand_id","style_id","color_id","size_type","size_id"];P.some(I=>x.includes(I))?c.value=1:P.some(I=>D.includes(I))&&(c.value=2)}}finally{h.value=!1}},pe=async()=>{if(!!l.value){q.value=!0;try{const v=await n.fetchProductById(m.params.id);de(v)}catch(v){console.error("Failed to fetch product:",v)}finally{q.value=!1}}},ve=async()=>{try{await p.fetchAllAttributes()}catch(v){console.error("Failed to load product attributes:",v)}};return ke(async()=>{await ve(),l.value?await pe():ue()}),ze(()=>s.value,()=>{_.value={}},{deep:!0}),(v,u)=>(B(),T("div",yt,[Y(p).isLoading?(B(),T("div",ht,[i(Ue,{color:"primary",size:"3em"})])):ee("",!0),o("div",{class:"bg-white rounded-lg shadow p-3 pt-2",style:Ve({opacity:Y(p).isLoading?"0.5":"1"})},[o("h1",St,z(U.value),1),i(Je,{modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=w=>c.value=w),ref_key:"stepper",ref:a,color:"primary",animated:"",flat:"",swipeable:"",contracted:v.$q.screen.lt.md,class:"shadow-none"},{default:N(()=>[i(j,{name:1,title:"Photos & Details",icon:"fas fa-camera",done:c.value>1},null,8,["done"]),i(j,{name:2,title:"Categories",icon:"fas fa-tag",done:c.value>2},null,8,["done"]),i(j,{name:3,title:"Review",icon:"fas fa-check",done:c.value>3},null,8,["done"])]),_:1},8,["modelValue","contracted"]),i(te,{modelValue:c.value,"onUpdate:modelValue":u[1]||(u[1]=w=>c.value=w),"transition-prev":"slide-right","transition-next":"slide-left",swipeable:"",animated:"",height:"auto",class:"q-mb-sm bg-transparent shadow-none",ref_key:"carousel",ref:t},{default:N(()=>[i(E,{name:1,class:"column q-pa-xs"},{default:N(()=>[i(Le,{"initial-data":s.value,"api-errors":_.value,"onUpdate:data":le,"onUpdate:errors":L},null,8,["initial-data","api-errors"]),o("div",xt,[i($,{color:"primary",label:"Continue",onClick:V,disabled:!r.value,"no-caps":"",dense:""},null,8,["disabled"])])]),_:1}),i(E,{name:2,class:"column q-pa-xs"},{default:N(()=>[i(We,{"initial-data":s.value,"api-errors":_.value,"onUpdate:data":oe,"onUpdate:errors":L},null,8,["initial-data","api-errors"]),o("div",Ct,[i($,{outline:"",color:"grey",label:"Back",onClick:M,"no-caps":"",dense:""}),i($,{color:"primary",label:"Continue",onClick:V,disabled:!d.value,"no-caps":"",dense:""},null,8,["disabled"])])]),_:1}),i(E,{name:3,class:"column q-pa-xs"},{default:N(()=>[i(bt,{"product-data":s.value,"is-edit-mode":l.value,"is-submitting":h.value,onBack:M,onSubmit:ne},null,8,["product-data","is-edit-mode","is-submitting"])]),_:1})]),_:1},8,["modelValue"])],4),i(Ie,{modelValue:y.value,"onUpdate:modelValue":u[2]||(u[2]=w=>y.value=w),persistent:""},{default:N(()=>[i(Be,null,{default:N(()=>[i(H,{class:"row items-center"},{default:N(()=>u[4]||(u[4]=[o("div",{class:"text-h6"},"Confirm Submission",-1)])),_:1}),i(H,null,{default:N(()=>[Qe(" Are you sure you want to "+z(l.value?"update":"create")+" this product? ",1)]),_:1}),i(Ke,{align:"right"},{default:N(()=>[X(i($,{flat:"",label:"Cancel",color:"primary"},null,512),[[Ae]]),i($,{flat:"",label:"Confirm",color:"primary",onClick:ie})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(Me,{modelValue:C.value,"onUpdate:modelValue":u[3]||(u[3]=w=>C.value=w),message:l.value?"Your product has been updated!":"Your product has been listed!"},null,8,["modelValue","message"])]))}};var Mt=Pe(qt,[["__scopeId","data-v-573cb898"]]);export{Mt as default};
