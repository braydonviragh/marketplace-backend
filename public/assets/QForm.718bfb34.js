import{I as A,J as l,x,r as D,ak as B,al as C,l as T,B as _,D as E,E as k,bd as I,V as P,aj as V,ai as q,ba as M,af as R}from"./index.fad208ab.js";const U=A("payments",{state:()=>({balance:"0.00",transactions:[],currentTransaction:null,pagination:{currentPage:1,totalPages:1,perPage:15},isLoading:!1,error:null,withdrawalStatus:null}),getters:{getBalance:t=>t.balance,getTransactions:t=>t.transactions,getCurrentTransaction:t=>t.currentTransaction,getPagination:t=>t.pagination,getCurrentMonthTotal:t=>{const e=new Date,a=e.getMonth(),n=e.getFullYear();return t.transactions.filter(c=>{const o=new Date(c.created_at);return o.getMonth()===a&&o.getFullYear()===n}).reduce((c,o)=>c+parseFloat(o.amount),0).toFixed(2)}},actions:{async fetchBalance(){var t,e;try{this.isLoading=!0;const a=await l.get("/balance");return this.balance=a.data.data.balance,this.balance}catch(a){throw this.error=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to fetch balance",a}finally{this.isLoading=!1}},async initiateWithdraw(){var t,e;try{return this.isLoading=!0,(await l.get("/balance/withdraw")).data}catch(a){throw this.error=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to initiate withdrawal",a}finally{this.isLoading=!1}},async confirmWithdraw(t={}){var e,a;try{this.isLoading=!0;const n=await l.post("/balance/withdraw",{amount:parseFloat(t.amount),notes:t.notes||""});return await this.fetchBalance(),this.withdrawalStatus="success",n.data}catch(n){throw this.withdrawalStatus="error",this.error=((a=(e=n.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to process withdrawal",n}finally{this.isLoading=!1}},async fetchTransactions(t={}){var e,a;try{this.isLoading=!0;const n=await l.get("/transactions",{params:{page:this.pagination.currentPage,per_page:this.pagination.perPage,...t}});return this.pagination={currentPage:n.data.meta.current_page,totalPages:n.data.meta.last_page,perPage:n.data.meta.per_page},this.transactions=n.data.data,n.data.data}catch(n){throw this.error=((a=(e=n.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to fetch transactions",n}finally{this.isLoading=!1}},async fetchTransactionById(t){var e,a;try{this.isLoading=!0;const n=await l.get(`/transactions/${t}`);return this.currentTransaction=n.data.data,n.data.data}catch(n){throw this.error=((a=(e=n.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to fetch transaction",n}finally{this.isLoading=!1}},resetPagination(){this.pagination={currentPage:1,totalPages:1,perPage:15}},async init(){await Promise.all([this.fetchBalance(),this.fetchTransactions()])}}}),Y=A("stripe",{state:()=>({stripeAccount:null,isLoading:!1,error:null}),getters:{hasStripeAccount:t=>{var e;return!!((e=t.stripeAccount)!=null&&e.account_id)},isAccountEnabled:t=>{var e;return(e=t.stripeAccount)==null?void 0:e.account_enabled},isAccountVerified:t=>{var e;return!!((e=t.stripeAccount)!=null&&e.account_verified_at)},getAccountDetails:t=>{var e;return((e=t.stripeAccount)==null?void 0:e.account_details)||{}}},actions:{async fetchStripeAccount(){var t,e;try{this.isLoading=!0;const a=await l.get("/stripe/account");return this.stripeAccount=a.data.data,this.stripeAccount}catch(a){throw this.error=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to fetch Stripe account",a}finally{this.isLoading=!1}},async createStripeAccount(){var t,e;try{this.isLoading=!0;const a=await l.post("/stripe/account");return this.stripeAccount=a.data.data,a.data}catch(a){throw this.error=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to create Stripe account",a}finally{this.isLoading=!1}},async getAccountLink(){var t,e;try{return this.isLoading=!0,(await l.get("/stripe/account/link")).data.url}catch(a){throw this.error=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to get Stripe account link",a}finally{this.isLoading=!1}},async getDashboardLink(){var t,e;try{return this.isLoading=!0,(await l.get("/stripe/dashboard")).data.url}catch(a){throw this.error=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to get Stripe dashboard link",a}finally{this.isLoading=!1}}}}),$=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),O=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});var W=x({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(t,{slots:e,emit:a}){const n=k(),c=D(null);let o=0;const h=[];function p(r){const d=typeof r=="boolean"?r:t.noErrorFocus!==!0,g=++o,v=(s,i)=>{a(`validation${s===!0?"Success":"Error"}`,i)},S=s=>{const i=s.validate();return typeof i.then=="function"?i.then(u=>({valid:u,comp:s}),u=>({valid:!1,comp:s,err:u})):Promise.resolve({valid:i,comp:s})};return(t.greedy===!0?Promise.all(h.map(S)).then(s=>s.filter(i=>i.valid!==!0)):h.reduce((s,i)=>s.then(()=>S(i).then(u=>{if(u.valid===!1)return Promise.reject(u)})),Promise.resolve()).catch(s=>[s])).then(s=>{if(s===void 0||s.length===0)return g===o&&v(!0),!0;if(g===o){const{comp:i,err:u}=s[0];if(u!==void 0&&console.error(u),v(!1,i),d===!0){const F=s.find(({comp:L})=>typeof L.focus=="function"&&I(L.$)===!1);F!==void 0&&F.comp.focus()}}return!1})}function m(){o++,h.forEach(r=>{typeof r.resetValidation=="function"&&r.resetValidation()})}function y(r){r!==void 0&&P(r);const d=o+1;p().then(g=>{d===o&&g===!0&&(t.onSubmit!==void 0?a("submit",r):r!==void 0&&r.target!==void 0&&typeof r.target.submit=="function"&&r.target.submit())})}function w(r){r!==void 0&&P(r),a("reset"),V(()=>{m(),t.autofocus===!0&&t.noResetFocus!==!0&&f()})}function f(){q(()=>{if(c.value===null)return;const r=c.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||c.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||c.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(c.value.querySelectorAll("[tabindex]"),d=>d.tabIndex!==-1);r!=null&&r.focus({preventScroll:!0})})}M(R,{bindComponent(r){h.push(r)},unbindComponent(r){const d=h.indexOf(r);d!==-1&&h.splice(d,1)}});let b=!1;return B(()=>{b=!0}),C(()=>{b===!0&&t.autofocus===!0&&f()}),T(()=>{t.autofocus===!0&&f()}),Object.assign(n.proxy,{validate:p,resetValidation:m,submit:y,reset:w,focus:f,getValidationComponents:()=>h}),()=>_("form",{class:"q-form",ref:c,onSubmit:y,onReset:w},E(e.default))}});export{W as Q,$ as a,Y as b,O as f,U as u};
