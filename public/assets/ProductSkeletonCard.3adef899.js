import{I as C,u as p,J as f,K as W,r as z,m as P,L as $,c as F,_ as k,o as c,a as h,d as o,t as l,M as B,f as w,N,j as y,p as v,n as m,h as x,w as b,O as _,P as A}from"./index.aed2db9c.js";import{Q as S}from"./QChip.bb92b358.js";const q=C("favorites",{state:()=>({favorites:[],loading:!1,error:null}),getters:{getFavorites:e=>e.favorites,isFavorite:e=>r=>e.favorites.some(t=>t.product_id===r)},actions:{async fetchFavorites(){var r,t;if(!p().isAuthenticated)return[];try{this.loading=!0,this.error=null;const s=await f.get("/favorites");return this.favorites=s.data.data,this.favorites}catch(s){return console.error("Error fetching favorites:",s),this.error=((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to load favorites",[]}finally{this.loading=!1}},async toggleFavorite(e){var s,d;const r=p(),{showAuthOverlay:t}=W();if(!r.isAuthenticated){t();return}try{if(this.loading=!0,this.error=null,this.isFavorite(e))await f.delete(`/favorites/${e}`),this.favorites=this.favorites.filter(a=>a.product_id!==e);else{const a=await f.post("/favorites",{product_id:e});this.favorites.push(a.data.data)}}catch(a){console.error("Error toggling favorite:",a),this.error=((d=(s=a.response)==null?void 0:s.data)==null?void 0:d.message)||"Failed to update favorites"}finally{this.loading=!1}},addFavorite(e){this.isFavorite(e.product_id)||this.favorites.push(e)},removeFavorite(e){this.favorites=this.favorites.filter(r=>r.product_id!==e)},clearFavorites(){this.favorites=[]}}});function L(e="45vw",r="160px"){const t=z(typeof window!="undefined"?window.innerWidth:1024),s=()=>{t.value=window.innerWidth};P(()=>{window.addEventListener("resize",s),t.value=window.innerWidth}),$(()=>{window.removeEventListener("resize",s)});const d=F(()=>{let a;return t.value>=1280?a=5:t.value>=1024?a=4:t.value>=768?a=3:t.value>=640?a=2.5:a=2.2,`${(100-2.5)/a}vw`});return{viewportWidth:t,cardWidth:d,minWidth:r}}const R=["src","alt"],V={class:"absolute bottom-2 left-2 bg-primary bg-opacity-70 text-white text-xs px-2 py-1 rounded-full"},E={class:"p-3 flex-grow flex flex-col w-full overflow-hidden"},j={class:"font-medium text-sm truncate mb-1 w-full"},H={class:"text-xs text-gray-500 mb-2 flex items-center w-full overflow-hidden"},I={class:"truncate"},M={class:"flex gap-1 flex-wrap mt-auto w-full overflow-hidden"},O={__name:"ProductCardRow",props:{product:{type:Object,required:!0},isFavorite:{type:Boolean,default:!1},isAuthenticated:{type:Boolean,default:!1},fixedWidth:{type:Boolean,default:!1},width:{type:String,default:"45vw"},imageHeight:{type:String,default:"185px"},inCategoryRow:{type:Boolean,default:!1}},emits:["click","toggle-favorite","image-error"],setup(e,{emit:r}){const t=e,{cardWidth:s}=L(t.width),d=F(()=>t.inCategoryRow?{width:s.value}:t.fixedWidth?{width:t.width,minWidth:"160px"}:{width:"100%"}),a=i=>{if(!i.media||i.media.length===0)return"https://via.placeholder.com/185x185?text=No+Image";const n=i.media.find(u=>u.is_primary)||i.media[0];return n.url||n.path},g=i=>i.location?i.location.city||i.location.formatted_address||"Location":i.city||"Location unavailable";return(i,n)=>(c(),h("div",{class:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden flex flex-col flex-shrink-0 transition-all duration-200 ease-in-out hover:-translate-y-1 hover:shadow-md cursor-pointer box-border",style:m(d.value),onClick:n[1]||(n[1]=u=>i.$emit("click"))},[o("div",{class:"relative w-full",style:m({height:e.imageHeight})},[o("img",{src:a(e.product),class:"w-full h-full object-cover transition-transform duration-300 hover:scale-105",alt:e.product.name||e.product.title},null,8,R),o("div",V," $"+l(e.product.rental_price||e.product.price||"0.00")+" / day ",1),e.isAuthenticated?(c(),h("button",{key:0,class:"absolute top-2 right-2 w-8 h-8 flex items-center justify-center bg-white bg-opacity-70 rounded-full shadow-sm",onClick:n[0]||(n[0]=B(u=>i.$emit("toggle-favorite"),["stop"]))},[w(y,{name:e.isFavorite?"favorite":"favorite_border",class:N(e.isFavorite?"text-negative":"text-gray-700"),size:"sm"},null,8,["name","class"])])):v("",!0)],4),o("div",E,[o("h3",j,l(e.product.name||e.product.title),1),o("div",H,[w(y,{name:"location_on",size:"xs",class:"mr-1 flex-shrink-0"}),o("span",I,l(g(e.product)),1)]),o("div",M,[e.product.category?(c(),x(S,{key:0,dense:"",size:"sm",outline:"",class:"text-xs text-primary truncate"},{default:b(()=>[_(l(e.product.category.name),1)]),_:1})):v("",!0),e.product.size?(c(),x(S,{key:1,dense:"",size:"sm",outline:"",class:"text-xs text-primary truncate"},{default:b(()=>[_(l(e.product.size.display_name||e.product.size.name),1)]),_:1})):v("",!0)])])],4))}};var D=k(O,[["__scopeId","data-v-23b20864"]]);const Q={class:"product-skeleton-card"},G={__name:"ProductSkeletonCard",props:{imageHeight:{type:String,default:"220px"},minWidth:{type:String,default:null},maxWidth:{type:String,default:null}},setup(e){return(r,t)=>(c(),h("div",Q,[o("div",{class:"bg-gray-200 rounded-t-lg animate-pulse",style:m({height:e.imageHeight||"220px"})},null,4),t[0]||(t[0]=A('<div class="p-3" data-v-65c05710><div class="h-4 bg-gray-200 rounded w-3/4 mb-2 animate-pulse" data-v-65c05710></div><div class="h-3 bg-gray-200 rounded w-1/2 mb-3 animate-pulse" data-v-65c05710></div><div class="flex gap-1" data-v-65c05710><div class="h-5 bg-gray-200 rounded w-16 animate-pulse" data-v-65c05710></div><div class="h-5 bg-gray-200 rounded w-14 animate-pulse" data-v-65c05710></div></div></div>',1))]))}};var J=k(G,[["__scopeId","data-v-65c05710"]]);export{J as P,q as a,D as b,L as u};
