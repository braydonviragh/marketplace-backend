import{Q as M}from"./QChip.bb92b358.js";import{e as X,a as Y,c as J,g as G,b as H,f as R}from"./QInput.52b28155.js";import{u as Z,b as ee}from"./private.use-form.e6da8665.js";import{r as q,c as d,E as B,a6 as te,W as U,a0 as ae,B as S,y as ie,ai as le,a5 as ne,I as se,J as y}from"./index.aed2db9c.js";import{h as re}from"./format.8ac60962.js";function x(e,o,g,p){const n=[];return e.forEach(r=>{p(r)===!0?n.push(r):o.push({failedPropValidation:g,file:r})}),n}function I(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),U(e)}const ue={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},oe=["rejected"];function ce({editable:e,dnd:o,getFileInput:g,addFilesToQueue:p}){const{props:n,emit:r,proxy:h}=B(),b=q(null),z=d(()=>n.accept!==void 0?n.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),A=d(()=>parseInt(n.maxFiles,10)),N=d(()=>parseInt(n.maxTotalSize,10));function P(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&te(t);else{const m=g();m&&m!==t.target&&m.click(t)}}function _(t){e.value&&t&&p(null,t)}function k(t,m,C,V){let i=Array.from(m||t.target.files);const f=[],F=()=>{f.length!==0&&r("rejected",f)};if(n.accept!==void 0&&z.value.indexOf("*/")===-1&&(i=x(i,f,"accept",l=>z.value.some(u=>l.type.toUpperCase().startsWith(u)||l.name.toUpperCase().endsWith(u))),i.length===0))return F();if(n.maxFileSize!==void 0){const l=parseInt(n.maxFileSize,10);if(i=x(i,f,"max-file-size",u=>u.size<=l),i.length===0)return F()}if(n.multiple!==!0&&i.length!==0&&(i=[i[0]]),i.forEach(l=>{l.__key=l.webkitRelativePath+l.lastModified+l.name+l.size}),V===!0){const l=C.map(u=>u.__key);i=x(i,f,"duplicate",u=>l.includes(u.__key)===!1)}if(i.length===0)return F();if(n.maxTotalSize!==void 0){let l=V===!0?C.reduce((u,T)=>u+T.size,0):0;if(i=x(i,f,"max-total-size",u=>(l+=u.size,l<=N.value)),i.length===0)return F()}if(typeof n.filter=="function"){const l=n.filter(i);i=x(i,f,"filter",u=>l.includes(u))}if(n.maxFiles!==void 0){let l=V===!0?C.length:0;if(i=x(i,f,"max-files",()=>(l++,l<=A.value)),i.length===0)return F()}if(F(),i.length!==0)return i}function O(t){I(t),o.value!==!0&&(o.value=!0)}function s(t){U(t),(t.relatedTarget!==null||ae.is.safari!==!0?t.relatedTarget!==b.value:document.elementsFromPoint(t.clientX,t.clientY).includes(b.value)===!1)===!0&&(o.value=!1)}function j(t){I(t);const m=t.dataTransfer.files;m.length!==0&&p(null,m),o.value=!1}function w(t){if(o.value===!0)return S("div",{ref:b,class:`q-${t}__dnd absolute-full`,onDragenter:I,onDragover:I,onDragleave:s,onDrop:j})}return Object.assign(h,{pickFiles:P,addFiles:_}),{pickFiles:P,addFiles:_,onDragover:O,onDragleave:s,processFiles:k,getDndNode:w,maxFilesNumber:A,maxTotalSizeNumber:N}}var he=ie({name:"QFile",inheritAttrs:!1,props:{...X,...Z,...ue,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Y,...oe],setup(e,{slots:o,emit:g,attrs:p}){const{proxy:n}=B(),r=J(),h=q(null),b=q(!1),z=ee(e),{pickFiles:A,onDragover:N,onDragleave:P,processFiles:_,getDndNode:k}=ce({editable:r.editable,dnd:b,getFileInput:L,addFilesToQueue:Q}),O=G(e),s=d(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),j=d(()=>R(s.value)),w=d(()=>s.value.map(a=>a.name).join(", ")),t=d(()=>re(s.value.reduce((a,c)=>a+c.size,0))),m=d(()=>({totalSize:t.value,filesNumber:s.value.length,maxFiles:e.maxFiles})),C=d(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:z.value,...p,id:r.targetUid.value,disabled:r.editable.value!==!0})),V=d(()=>"q-file q-field--auto-height"+(b.value===!0?" q-file--dnd":"")),i=d(()=>e.multiple===!0&&e.append===!0);function f(a){const c=s.value.slice();c.splice(a,1),l(c)}function F(a){const c=s.value.indexOf(a);c!==-1&&f(c)}function l(a){g("update:modelValue",e.multiple===!0?a:a[0])}function u(a){a.keyCode===13&&ne(a)}function T(a){(a.keyCode===13||a.keyCode===32)&&A(a)}function L(){return h.value}function Q(a,c){const v=_(a,c,s.value,i.value),E=L();E!=null&&(E.value=""),v!==void 0&&((e.multiple===!0?e.modelValue&&v.every(K=>s.value.includes(K)):e.modelValue===v[0])||l(i.value===!0?s.value.concat(v):v))}function D(){return[S("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function W(){if(o.file!==void 0)return s.value.length===0?D():s.value.map((c,v)=>o.file({index:v,file:c,ref:this}));if(o.selected!==void 0)return s.value.length===0?D():o.selected({files:s.value,ref:this});if(e.useChips===!0)return s.value.length===0?D():s.value.map((c,v)=>S(M,{key:"file-"+v,removable:r.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{f(v)}},()=>S("span",{class:"ellipsis",textContent:c.name})));const a=e.displayValue!==void 0?e.displayValue:w.value;return a.length!==0?[S("div",{class:e.inputClass,style:e.inputStyle,textContent:a})]:D()}function $(){const a={ref:h,...C.value,...O.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:Q};return e.multiple===!0&&(a.multiple=!0),S("input",a)}return Object.assign(r,{fieldClass:V,emitValue:l,hasValue:j,inputRef:h,innerValue:s,floatingLabel:d(()=>j.value===!0||R(e.displayValue)),computedCounter:d(()=>{if(e.counterLabel!==void 0)return e.counterLabel(m.value);const a=e.maxFiles;return`${s.value.length}${a!==void 0?" / "+a:""} (${t.value})`}),getControlChild:()=>k("file"),getControl:()=>{const a={ref:r.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return r.editable.value===!0&&Object.assign(a,{onDragover:N,onDragleave:P,onKeydown:u,onKeyup:T}),S("div",a,[$()].concat(W()))}}),Object.assign(n,{removeAtIndex:f,removeFile:F,getNativeElement:()=>h.value}),le(n,"nativeEl",()=>h.value),H(r)}});const pe=se("productAttributes",{state:()=>({categories:[],brands:[],styles:[],colors:[],letterSizes:[],numberSizes:[],waistSizes:[],isLoading:!1,error:null}),actions:{async fetchAllAttributes(){var e,o;try{this.isLoading=!0;const[g,p,n,r,h,b,z]=await Promise.all([y.get("/categories"),y.get("/brands"),y.get("/styles"),y.get("/colors"),y.get("/sizes/letter"),y.get("/sizes/number"),y.get("/sizes/waist")]);this.categories=g.data.data,this.brands=p.data.data,this.styles=n.data.data,this.colors=r.data.data,this.letterSizes=h.data.data,this.numberSizes=b.data.data,this.waistSizes=z.data.data}catch(g){throw this.error=((o=(e=g.response)==null?void 0:e.data)==null?void 0:o.message)||"Failed to fetch attributes",g}finally{this.isLoading=!1}}}});export{he as Q,pe as u};
