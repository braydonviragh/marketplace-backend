import{I as k,u as g,J as v,K as F,r as C,l as W,L as z,A as P,_ as S,o as c,c as h,a as o,t as l,M as $,f as w,N as A,i as y,m as f,n as m,h as p,w as x,O as b,e as B,P as N}from"./index.c533f99f.js";import{Q as _}from"./QChip.7995d9ec.js";const D=k("favorites",{state:()=>({favorites:[],loading:!1,error:null}),getters:{getFavorites:e=>e.favorites,isFavorite:e=>s=>e.favorites.some(t=>t.product_id===s)},actions:{async fetchFavorites(){var s,t;if(!g().isAuthenticated)return[];try{this.loading=!0,this.error=null;const r=await v.get("/favorites");return this.favorites=r.data.data,this.favorites}catch(r){return console.error("Error fetching favorites:",r),this.error=((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to load favorites",[]}finally{this.loading=!1}},async toggleFavorite(e){var r,d;const s=g(),{showAuthOverlay:t}=F();if(!s.isAuthenticated){t();return}try{if(this.loading=!0,this.error=null,this.isFavorite(e))await v.delete(`/favorites/${e}`),this.favorites=this.favorites.filter(a=>a.product_id!==e);else{const a=await v.post("/favorites",{product_id:e});this.favorites.push(a.data.data)}}catch(a){console.error("Error toggling favorite:",a),this.error=((d=(r=a.response)==null?void 0:r.data)==null?void 0:d.message)||"Failed to update favorites"}finally{this.loading=!1}},addFavorite(e){this.isFavorite(e.product_id)||this.favorites.push(e)},removeFavorite(e){this.favorites=this.favorites.filter(s=>s.product_id!==e)},clearFavorites(){this.favorites=[]}}});function L(e="45vw",s="160px"){const t=C(typeof window!="undefined"?window.innerWidth:1024),r=()=>{t.value=window.innerWidth};W(()=>{window.addEventListener("resize",r),t.value=window.innerWidth}),z(()=>{window.removeEventListener("resize",r)});const d=P(()=>{let a;return t.value>=1280?a=5:t.value>=1024?a=4:t.value>=768?a=3:t.value>=640?a=2.5:a=2,`${95/a}vw`});return{viewportWidth:t,cardWidth:d,minWidth:s}}const V=["src","alt"],E={class:"absolute bottom-2 left-2 bg-primary bg-opacity-70 text-white text-xs px-2 py-1 rounded-full"},H={class:"p-3 flex-grow flex flex-col w-full overflow-hidden"},I={class:"font-medium text-sm truncate mb-1 w-full"},M={class:"text-xs text-gray-500 mb-2 flex items-center w-full overflow-hidden"},O={class:"truncate"},R={class:"flex gap-1 flex-wrap mt-auto w-full overflow-hidden"},j={__name:"ProductCardRow",props:{product:{type:Object,required:!0},isFavorite:{type:Boolean,default:!1},isAuthenticated:{type:Boolean,default:!1},fixedWidth:{type:Boolean,default:!0},width:{type:String,default:"45vw"},imageHeight:{type:String,default:"185px"}},emits:["click","toggle-favorite","image-error"],setup(e,{emit:s}){const t=e,{cardWidth:r}=L(t.width),d=i=>{if(!i.media||i.media.length===0)return"https://via.placeholder.com/185x185?text=No+Image";const n=i.media.find(u=>u.is_primary)||i.media[0];return n.url||n.path},a=i=>i.location?i.location.city||i.location.formatted_address||"Location":i.city||"Location unavailable";return(i,n)=>(c(),h("div",{class:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden flex flex-col flex-shrink-0 transition-all duration-200 ease-in-out hover:-translate-y-1 hover:shadow-md cursor-pointer box-border",style:m({width:B(r)}),onClick:n[1]||(n[1]=u=>i.$emit("click"))},[o("div",{class:"relative w-full",style:m({height:e.imageHeight})},[o("img",{src:d(e.product),class:"w-full h-full object-cover transition-transform duration-300 hover:scale-105",alt:e.product.name||e.product.title},null,8,V),o("div",E," $"+l(e.product.rental_price||e.product.price||"0.00")+" / day ",1),e.isAuthenticated?(c(),h("button",{key:0,class:"absolute top-2 right-2 w-8 h-8 flex items-center justify-center bg-white bg-opacity-70 rounded-full shadow-sm",onClick:n[0]||(n[0]=$(u=>i.$emit("toggle-favorite"),["stop"]))},[w(y,{name:e.isFavorite?"favorite":"favorite_border",class:A(e.isFavorite?"text-negative":"text-gray-700"),size:"sm"},null,8,["name","class"])])):f("",!0)],4),o("div",H,[o("h3",I,l(e.product.name||e.product.title),1),o("div",M,[w(y,{name:"location_on",size:"xs",class:"mr-1 flex-shrink-0"}),o("span",O,l(a(e.product)),1)]),o("div",R,[e.product.category?(c(),p(_,{key:0,dense:"",size:"sm",outline:"",class:"text-xs text-primary truncate"},{default:x(()=>[b(l(e.product.category.name),1)]),_:1})):f("",!0),e.product.size?(c(),p(_,{key:1,dense:"",size:"sm",outline:"",class:"text-xs text-primary truncate"},{default:x(()=>[b(l(e.product.size.display_name||e.product.size.name),1)]),_:1})):f("",!0)])])],4))}};var J=S(j,[["__scopeId","data-v-0f8ee690"]]);const Q={class:"product-skeleton-card"},T={__name:"ProductSkeletonCard",props:{imageHeight:{type:String,default:"220px"},minWidth:{type:String,default:null},maxWidth:{type:String,default:null}},setup(e){return(s,t)=>(c(),h("div",Q,[o("div",{class:"bg-gray-200 rounded-t-lg animate-pulse",style:m({height:e.imageHeight||"220px"})},null,4),t[0]||(t[0]=N('<div class="p-3" data-v-65c05710><div class="h-4 bg-gray-200 rounded w-3/4 mb-2 animate-pulse" data-v-65c05710></div><div class="h-3 bg-gray-200 rounded w-1/2 mb-3 animate-pulse" data-v-65c05710></div><div class="flex gap-1" data-v-65c05710><div class="h-5 bg-gray-200 rounded w-16 animate-pulse" data-v-65c05710></div><div class="h-5 bg-gray-200 rounded w-14 animate-pulse" data-v-65c05710></div></div></div>',1))]))}};var K=S(T,[["__scopeId","data-v-65c05710"]]);export{K as P,D as a,J as b,L as u};
