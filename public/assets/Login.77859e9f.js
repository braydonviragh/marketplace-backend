import{_ as Q,f as L,aC as N,u as U,K as q,r as n,A as B,l as R,aA as F,o as h,c as w,a as t,e as o,i as _,t as I,m as j,L as k,w as v,Q as V,O as D,N as x}from"./index.fad208ab.js";import{Q as S}from"./QInput.41d87495.js";import{_ as E,Q as M}from"./green-logo.24d3d7d8.js";import{Q as O}from"./QSpinnerDots.284daff4.js";import"./use-id.d7e26954.js";import"./private.use-form.81163b54.js";import"./use-checkbox.f0a8805c.js";const $={class:"login-page min-h-screen bg-white flex flex-col justify-center p-4"},W={class:"max-w-md mx-auto w-full fade-in"},z={key:0,class:"mb-6 p-4 bg-red-50 text-red-700 rounded-lg text-sm"},K={class:"flex items-center"},T={class:"bg-white rounded-lg shadow-sm border border-gray-100 p-6"},Y={class:"flex justify-between items-center"},G={class:"pt-2"},H={class:"text-center text-sm text-gray-500 pt-4"},J={class:"text-center text-xs mt-4"},X={__name:"Login",setup(Z){const a=L(),p=N(),g=U(),{hideAuthOverlay:C}=q(),i=n(""),u=n(""),d=n(!1),c=n(!1),f=n(!1),m=n(""),b=B(()=>i.value&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.value)&&u.value),A=async()=>{var r,e;if(!!b.value){f.value=!0,m.value="";try{const l={email:i.value,password:u.value,remember:d.value};console.log("Attempting login with:",{email:i.value,remember:d.value});const s=await p.login(l);if(console.log("Login response:",s),s&&s.phone_verified===!1){console.log("Phone verification required, redirecting to verification page"),a.push("/verify-phone");return}!g.currentUser&&p.token&&(console.log("Fetching user data..."),await g.fetchCurrentUser(),console.log("User data fetched:",g.currentUser));const y=a.currentRoute.value.query.redirect||"/home";console.log("Redirecting to:",y),await a.replace(y)}catch(l){console.error("Login error:",l),m.value=((e=(r=l.response)==null?void 0:r.data)==null?void 0:e.message)||"Failed to login. Please check your credentials."}finally{f.value=!1}}},P=()=>{C(),a.push({name:"landing"}).catch(r=>{console.error("Navigation error:",r),a.push("/")})};return R(()=>{if(p.isAuthenticated){const r=a.currentRoute.value.query.redirect||"/";a.push(r)}}),(r,e)=>{const l=F("router-link");return h(),w("div",$,[t("div",W,[e[10]||(e[10]=t("div",{class:"text-center mb-8"},[t("img",{src:E,alt:"Logo",class:"h-14 mx-auto mb-4"}),t("h1",{class:"text-2xl font-medium text-primary mb-1"},"Welcome Back"),t("p",{class:"text-gray-500 text-sm"},"Sign in to continue to your account")],-1)),m.value?(h(),w("div",z,[t("div",K,[o(_,{name:"error",class:"mr-2"}),t("span",null,I(m.value),1)])])):j("",!0),t("div",T,[t("form",{onSubmit:k(A,["prevent"]),class:"space-y-5"},[t("div",null,[e[4]||(e[4]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),o(S,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=s=>i.value=s),type:"email",outlined:"",class:"bg-white",placeholder:"your@email.com",rules:[s=>!!s||"Email is required",s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)||"Please enter a valid email"],"stack-label":"",dense:""},null,8,["modelValue","rules"])]),t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Password",-1)),o(S,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=s=>u.value=s),type:c.value?"text":"password",outlined:"",class:"bg-white",placeholder:"Your password",rules:[s=>!!s||"Password is required"],"stack-label":"",dense:""},{append:v(()=>[o(_,{name:c.value?"visibility":"visibility_off",class:"cursor-pointer text-gray-400",onClick:e[1]||(e[1]=s=>c.value=!c.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"])]),t("div",Y,[o(M,{modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=s=>d.value=s),label:"Remember me",color:"primary",dense:"",class:"text-sm"},null,8,["modelValue"]),o(l,{to:"/forgot-password",class:"text-sm text-primary hover:text-primary-dark"},{default:v(()=>e[6]||(e[6]=[x(" Forgot password? ")])),_:1})]),t("div",G,[o(V,{type:"submit",label:"Sign In",class:"w-full",color:"primary",loading:f.value,disable:!b.value,"no-caps":""},{loading:v(()=>[o(O,{color:"white",size:"1.5em"})]),_:1},8,["loading","disable"])]),e[9]||(e[9]=D('<div class="relative pt-2" data-v-051e1b94><div class="absolute inset-0 flex items-center" data-v-051e1b94><div class="w-full border-t border-gray-100" data-v-051e1b94></div></div><div class="relative flex justify-center" data-v-051e1b94><span class="bg-white px-4 text-xs text-gray-400" data-v-051e1b94>or</span></div></div>',1)),t("div",null,[o(V,{label:"Sign in with Phone Number",class:"w-full text-gray-700",outline:"","no-caps":"",to:"/phone-login"})]),t("div",H,[e[8]||(e[8]=x(" Don't have an account? ")),o(l,{to:"/register",class:"text-primary font-medium"},{default:v(()=>e[7]||(e[7]=[x("Create Account")])),_:1})]),t("div",J,[t("a",{href:"#",onClick:k(P,["prevent"]),class:"text-gray-400 hover:text-gray-600 transition"}," Continue without an account ")])],32)])])])}}};var ie=Q(X,[["__scopeId","data-v-051e1b94"]]);export{ie as default};
