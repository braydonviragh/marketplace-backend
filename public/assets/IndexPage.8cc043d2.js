import{Q as F}from"./QSkeleton.93e60c06.js";import{r as x,u as I,_ as P,o as a,c as l,a as n,F as $,d as C,n as E,e as v,f as i,g as N,t as A,Q as V,h as B,i as J,j as R,k as T,l as D,m as L,w as k,p as H,q,s as W,v as U,C as G}from"./index.c533f99f.js";import{Q as O}from"./QSeparator.c5a25909.js";import{Q as M}from"./QCardActions.d8fc215a.js";import{u as Y,P as X,a as Z,b as K}from"./ProductSkeletonCard.45ad1bed.js";import"./QChip.7995d9ec.js";function ee(){const s=x(null),g=x(null),r=x(!1),d=I();return{coordinates:s,error:g,isLoading:r,getCurrentPosition:async()=>{var p,m;r.value=!0,g.value=null;try{const f=await new Promise((o,h)=>{navigator.geolocation.getCurrentPosition(o,h,{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})});return s.value={latitude:f.coords.latitude,longitude:f.coords.longitude},s.value}catch{const o=d.currentUser;return(p=o==null?void 0:o.profile)!=null&&p.postal_code?{postal_code:o.profile.postal_code}:(m=o==null?void 0:o.profile)!=null&&m.city?{city:o.profile.city}:(g.value="No location available",null)}finally{r.value=!1}}}}const te={class:"flex flex-nowrap overflow-x-auto gap-4 pb-3",style:{"min-width":"100%","scrollbar-width":"none","-ms-overflow-style":"none"}},oe={__name:"ProductSkeletonRow",props:{count:{type:Number,default:6},width:{type:String,default:"45vw"},imageHeight:{type:String,default:"185px"}},setup(s){const g=s,{cardWidth:r,minWidth:d}=Y(g.width);return(c,p)=>(a(),l("div",null,[n("div",te,[(a(!0),l($,null,C(s.count,m=>(a(),l("div",{key:`skeleton-${m}`,class:"flex-shrink-0 overflow-hidden",style:E({width:v(r),minWidth:v(d)})},[i(X,{"image-height":s.imageHeight},null,8,["image-height"])],4))),128))])]))}};var Q=P(oe,[["__scopeId","data-v-668d749d"]]);const se={class:"mb-8"},re={class:"flex justify-between items-center mb-4 px-4"},ae={class:"text-lg font-medium"},ie={key:0,class:"px-4"},ne={key:1,class:"px-4"},le={class:"bg-red-50 text-red-600 p-4 rounded-lg"},de={key:2,class:"relative"},ce={class:"flex flex-nowrap overflow-x-auto gap-4 py-2 px-4 pb-3",style:{"min-width":"100%","scrollbar-width":"none","-ms-overflow-style":"none"}},ue={key:3,class:"px-4 py-8 text-center text-gray-500"},ge={__name:"CategoryRow",props:{title:{type:String,required:!0},products:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null}},emits:["view-all"],setup(s,{emit:g}){const r=N(),d=I(),c=Z(),p=o=>c.isFavorite(o.id),m=async o=>{try{if(!d.isAuthenticated){r.push("/login");return}await c.toggleFavorite(o.id)}catch(h){console.error("Failed to toggle favorite:",h)}},f=o=>{r.push({name:"product-details",params:{id:o.id}})};return(o,h)=>(a(),l("div",se,[n("div",re,[n("h2",ae,A(s.title),1),i(V,{flat:"",dense:"",color:"primary",label:"View All",class:"text-sm","no-caps":"","icon-right":"chevron_right",onClick:h[0]||(h[0]=y=>o.$emit("view-all"))})]),s.loading&&s.products.length===0?(a(),l("div",ie,[i(Q,{count:6,width:"45vw","image-height":"185px"})])):s.error?(a(),l("div",ne,[n("div",le,A(s.error),1)])):s.products.length>0?(a(),l("div",de,[n("div",ce,[(a(!0),l($,null,C(s.products,y=>(a(),B(K,{key:y.id,product:y,"is-favorite":p(y),"is-authenticated":v(d).isAuthenticated,"fixed-width":!0,width:"45vw","image-height":"185px",onClick:_=>f(y),onToggleFavorite:_=>m(y)},null,8,["product","is-favorite","is-authenticated","onClick","onToggleFavorite"]))),128))])])):(a(),l("div",ue," No products available in this category "))]))}};var w=P(ge,[["__scopeId","data-v-cf8b6546"]]);const pe={class:"category-circle w-[70px] h-[70px] rounded-full p-[2px] cursor-pointer shadow-sm bg-white border border-gray-100"},me={class:"w-full h-full rounded-full overflow-hidden flex items-center justify-center bg-gray-50"},ve=["src","alt"],ye={class:"text-xs mt-2 font-medium truncate w-[70px] text-center"},fe={__name:"CategoryCircle",props:{category:{type:Object,required:!0}},emits:["click"],setup(s,{emit:g}){const r=d=>({Dresses:"mdi-human-female",Tops:"mdi-tshirt-crew",Handbags:"mdi-bag-personal",Accessories:"mdi-glasses",Activewear:"mdi-run-fast",Blazers:"mdi-human-male",Bodysuits:"mdi-human-female",Jeans:"mdi-jeans",Jewelry:"mdi-diamond-stone",Pants:"mdi-jeans",Jumpsuits:"mdi-human-handsdown",Shoes:"mdi-shoe-heel",Shorts:"mdi-jeans-short",Skirts:"mdi-human-female","Sweats & Hoodies":"mdi-face-man-profile","Sweaters & Knits":"mdi-scarf",Suits:"mdi-tuxedo",Other:"mdi-tshirt-crew-outline"})[d]||"mdi-tshirt-crew";return(d,c)=>(a(),l("div",{class:"flex flex-col items-center flex-shrink-0",onClick:c[0]||(c[0]=p=>d.$emit("click"))},[n("div",pe,[n("div",me,[s.category.image_url?(a(),l("img",{key:0,src:s.category.image_url,alt:s.category.name,class:"object-contain max-w-[22px] max-h-[22px] w-auto h-auto"},null,8,ve)):(a(),B(J,{key:1,name:r(s.category.name),class:"text-3xl text-primary"},null,8,["name"]))])]),n("span",ye,A(s.category.name),1)]))}};const he={class:"mb-8"},_e={class:"overflow-x-auto whitespace-nowrap scrollbar-hide"},we={class:"inline-flex flex-nowrap gap-4 px-4",style:{"min-width":"max-content"}},xe={__name:"CategorySlider",props:{categories:{type:Array,required:!0}},emits:["navigate"],setup(s,{emit:g}){return(r,d)=>(a(),l("div",he,[d[0]||(d[0]=n("div",{class:"px-4 mb-4"},[n("h2",{class:"text-xl font-semibold"},"Categories")],-1)),n("div",_e,[n("div",we,[(a(!0),l($,null,C(s.categories,c=>(a(),B(fe,{key:c.id,category:c,onClick:p=>r.$emit("navigate",c)},null,8,["category","onClick"]))),128))])])]))}};var be=P(xe,[["__scopeId","data-v-a07ac510"]]);const $e={class:"pb-16"},Ce={key:0,class:"p-4 pt-[65px]"},Ae={class:"mb-6"},ke={class:"px-4 mb-4"},Se={class:"overflow-x-auto whitespace-nowrap scrollbar-hide"},Pe={class:"inline-flex flex-nowrap gap-4 px-4",style:{"min-width":"max-content"}},Be={class:"px-4 mb-4"},Fe={key:1,class:"fade-in"},Ve={class:"text-xl font-medium q-mb-md"},Ie={class:"text-lg font-medium text-primary q-mb-sm"},qe={class:"text-gray-700"},Ne={__name:"IndexPage",setup(s){const g=N(),r=R(),d=I(),c=T(),p=x(!0),m=x(!1),f=x({title:"",sections:[]}),o=x({dresses:{loading:!0,products:[]},topsAndBodysuits:{loading:!0,products:[]},bottomEssentials:{loading:!0,products:[]},professionalAttire:{loading:!0,products:[]},cozyAndCasual:{loading:!0,products:[]},accessoriesAndJewelry:{loading:!0,products:[]}}),h=u=>{g.push({name:"products",query:{filter:u.name.toLowerCase()}})},y=(u=null,e={})=>{const t={...e};u&&(Array.isArray(u)?t.categories=u.join(","):t.category=u),g.push({name:"products",query:t})},_=(u,e)=>{g.push({name:"products",query:{category_ids:u.join(","),section:e}})},b=async(u,e)=>{o.value[e].loading=!0;try{console.log(`Fetching products for row ${e} with category IDs: ${u}`);const t=await r.fetchProductsByCategoryIds(u);!t||t.length===0?console.log(`No products found for ${e} with categories: ${u}`):console.log(`Found ${t.length} products for ${e}`),o.value[e].products=t||[]}catch(t){console.error(`Failed to fetch products for ${e}:`,t),o.value[e].products=[]}finally{o.value[e].loading=!1}};return D(async()=>{try{await c.fetchCategories(!0)}catch(t){console.error("Failed to fetch categories:",t)}const u=[b([1],"dresses"),b([2,7],"topsAndBodysuits"),b([8,10,12],"bottomEssentials"),b([6,16],"professionalAttire"),b([14,15],"cozyAndCasual"),b([4,9],"accessoriesAndJewelry")],e=[];e.push((async()=>{try{await r.fetchProducts({filter:"trending",per_page:15})}catch(t){console.error("Failed to fetch trending products:",t)}})()),e.push((async()=>{try{const{getCurrentPosition:t}=ee(),S=await t();if(S){const{latitude:j,longitude:z}=S.coords;await r.fetchNearbyProducts({latitude:j,longitude:z,radius:50})}}catch(t){console.error("Failed to fetch nearby products:",t)}})()),d.isAuthenticated&&(e.push(r.fetchTailoredProducts()),e.push(r.fetchFavoriteProducts()));try{await Promise.allSettled(u),await Promise.allSettled(e)}catch(t){console.error("Error fetching data:",t)}finally{p.value=!1}}),(u,e)=>(a(),l("div",$e,[p.value?(a(),l("div",Ce,[n("div",Ae,[n("div",ke,[i(F,{type:"text",width:"200px",class:"mb-2"})]),n("div",Se,[n("div",Pe,[(a(),l($,null,C(6,t=>i(F,{type:"circle",size:"70px",class:"flex-shrink-0",key:`story-${t}`})),64))])])]),(a(),l($,null,C(3,t=>n("div",{key:`section-${t}`,class:"mb-8"},[n("div",Be,[i(F,{type:"text",width:"200px"})]),i(Q,{count:5,width:"45vw","image-height":"185px"})])),64))])):(a(),l("div",Fe,[i(be,{categories:v(c).categories,onNavigate:h},null,8,["categories"]),i(w,{title:"Trending Now",products:v(r).trendingProducts,loading:v(r).isLoading,onViewAll:e[0]||(e[0]=t=>y())},null,8,["products","loading"]),i(w,{title:"Tops & Bodysuits",products:o.value.topsAndBodysuits.products,loading:o.value.topsAndBodysuits.loading,onViewAll:e[1]||(e[1]=t=>_([2,7],"Tops & Bodysuits"))},null,8,["products","loading"]),i(w,{title:"Bottom Essentials: Pants, Jeans & Shorts",products:o.value.bottomEssentials.products,loading:o.value.bottomEssentials.loading,onViewAll:e[2]||(e[2]=t=>_([8,10,12],"Bottom Essentials"))},null,8,["products","loading"]),i(w,{title:"Professional Attire: Blazers & Suits",products:o.value.professionalAttire.products,loading:o.value.professionalAttire.loading,onViewAll:e[3]||(e[3]=t=>_([6,16],"Professional Attire"))},null,8,["products","loading"]),i(w,{title:"Elegant Dresses",products:o.value.dresses.products,loading:o.value.dresses.loading,onViewAll:e[4]||(e[4]=t=>_([1],"Dresses"))},null,8,["products","loading"]),i(w,{title:"Cozy & Casual: Sweats & Knitwear",products:o.value.cozyAndCasual.products,loading:o.value.cozyAndCasual.loading,onViewAll:e[5]||(e[5]=t=>_([14,15],"Cozy & Casual"))},null,8,["products","loading"]),i(w,{title:"Stylish Accessories & Jewelry",products:o.value.accessoriesAndJewelry.products,loading:o.value.accessoriesAndJewelry.loading,onViewAll:e[6]||(e[6]=t=>_([4,9],"Accessories & Jewelry"))},null,8,["products","loading"]),v(r).nearbyProducts.length>0?(a(),B(w,{key:0,title:"Near You",products:v(r).nearbyProducts,loading:v(r).isLoadingNearby,error:v(r).locationError,onViewAll:e[7]||(e[7]=t=>y(null,{nearby:!0}))},null,8,["products","loading","error"])):L("",!0),i(U,{modelValue:m.value,"onUpdate:modelValue":e[9]||(e[9]=t=>m.value=t),position:"bottom"},{default:k(()=>[i(H,{class:"rounded-t-lg"},{default:k(()=>[i(q,{class:"text-center"},{default:k(()=>[n("h2",Ve,A(f.value.title),1),i(V,{round:"",flat:"",color:"grey",icon:"close",class:"absolute top-2 right-2",onClick:e[8]||(e[8]=t=>m.value=!1)})]),_:1}),i(O),i(q,{class:"q-pa-md"},{default:k(()=>[(a(!0),l($,null,C(f.value.sections,(t,S)=>(a(),l("div",{key:S,class:"q-mb-md"},[n("h3",Ie,A(t.title),1),n("p",qe,A(t.content),1)]))),128))]),_:1}),i(M,{align:"center",class:"q-pa-md"},{default:k(()=>[W(i(V,{label:"Got it",color:"primary",flat:""},null,512),[[G]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))]))}};var Te=P(Ne,[["__scopeId","data-v-fbafc8a6"]]);export{Te as default};
