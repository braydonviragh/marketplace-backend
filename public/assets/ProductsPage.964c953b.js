import{_ as Le,j as _e,W as pe,r as $,l as be,X as me,o as z,c as A,e as B,Y as vt,Z as mt,$ as ue,a0 as ft,a1 as _t,a2 as de,a3 as ke,a4 as Ne,a5 as Me,a6 as fe,a7 as $e,V as Qe,z as pt,A as d,a8 as bt,a9 as Ae,aa as We,y as gt,E as Ke,B as Q,S as yt,x as ht,a as S,s as Ue,C as Xe,Q as W,F as G,d as H,g as ie,M as re,w as ve,N as Ye,t as Ge,n as xt,k as He,h as N,m as ae,f as Ft,ab as Ct,u as wt,i as zt,ac as St,p as kt,v as Mt}from"./index.1c4d6210.js";import{Q as $t}from"./QChip.b69f4eda.js";import{P as At,u as Rt,a as Lt}from"./ProductSkeletonCard.232e2c76.js";import{Q as qt}from"./QInput.80880380.js";import{g as De,s as Oe}from"./touch.9135741d.js";import{c as Pt}from"./selection.f0756317.js";import{u as Et,a as Tt}from"./private.use-form.cfbbc316.js";import{b as U}from"./format.8ac60962.js";import"./use-id.0b69a5ed.js";const Vt={__name:"SearchBar",props:{initialQuery:{type:String,default:""}},emits:["search","input"],setup(r,{emit:y}){const v=r,a=y;_e();const e=pe(),l=$(""),m=()=>{a("input",l.value)},b=()=>{e.updateFilter("search",l.value||null),a("search",l.value||"")},c=()=>{l.value="",e.updateFilter("search",null),a("input",""),a("search","")};return be(()=>{l.value=v.initialQuery,v.initialQuery&&e.updateFilter("search",v.initialQuery)}),me(()=>e.activeFilters.search,h=>{h!==l.value&&(l.value=h||"")},{deep:!0}),(h,M)=>(z(),A("div",null,[B(qt,{modelValue:l.value,"onUpdate:modelValue":[M[0]||(M[0]=C=>l.value=C),m],placeholder:"Search for clothes...",filled:"",clearable:"",class:"search-input bg-white",onKeyup:vt(b,["enter"]),onBlur:b,onClear:c},null,8,["modelValue"])]))}};var It=Le(Vt,[["__scopeId","data-v-71c37c87"]]);function Re(r,y,v){const a=fe(r);let e,l=a.left-y.event.x,m=a.top-y.event.y,b=Math.abs(l),c=Math.abs(m);const h=y.direction;h.horizontal===!0&&h.vertical!==!0?e=l<0?"left":"right":h.horizontal!==!0&&h.vertical===!0?e=m<0?"up":"down":h.up===!0&&m<0?(e="up",b>c&&(h.left===!0&&l<0?e="left":h.right===!0&&l>0&&(e="right"))):h.down===!0&&m>0?(e="down",b>c&&(h.left===!0&&l<0?e="left":h.right===!0&&l>0&&(e="right"))):h.left===!0&&l<0?(e="left",b<c&&(h.up===!0&&m<0?e="up":h.down===!0&&m>0&&(e="down"))):h.right===!0&&l>0&&(e="right",b<c&&(h.up===!0&&m<0?e="up":h.down===!0&&m>0&&(e="down")));let M=!1;if(e===void 0&&v===!1){if(y.event.isFirst===!0||y.event.lastDir===void 0)return{};e=y.event.lastDir,M=!0,e==="left"||e==="right"?(a.left-=l,b=0,l=0):(a.top-=m,c=0,m=0)}return{synthetic:M,payload:{evt:r,touch:y.event.mouse!==!0,mouse:y.event.mouse===!0,position:a,direction:e,isFirst:y.event.isFirst,isFinal:v===!0,duration:Date.now()-y.event.time,distance:{x:b,y:c},offset:{x:l,y:m},delta:{x:a.left-y.event.lastX,y:a.top-y.event.lastY}}}}let Bt=0;var Nt=mt({name:"touch-pan",beforeMount(r,{value:y,modifiers:v}){if(v.mouse!==!0&&ue.has.touch!==!0)return;function a(l,m){v.mouse===!0&&m===!0?Qe(l):(v.stop===!0&&Me(l),v.prevent===!0&&Ne(l))}const e={uid:"qvtp_"+Bt++,handler:y,modifiers:v,direction:De(v),noop:ft,mouseStart(l){Oe(l,e)&&_t(l)&&(de(e,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),e.start(l,!0))},touchStart(l){if(Oe(l,e)){const m=l.target;de(e,"temp",[[m,"touchmove","move","notPassiveCapture"],[m,"touchcancel","end","passiveCapture"],[m,"touchend","end","passiveCapture"]]),e.start(l)}},start(l,m){if(ue.is.firefox===!0&&ke(r,!0),e.lastEvt=l,m===!0||v.stop===!0){if(e.direction.all!==!0&&(m!==!0||e.modifiers.mouseAllDir!==!0&&e.modifiers.mousealldir!==!0)){const h=l.type.indexOf("mouse")!==-1?new MouseEvent(l.type,l):new TouchEvent(l.type,l);l.defaultPrevented===!0&&Ne(h),l.cancelBubble===!0&&Me(h),Object.assign(h,{qKeyEvent:l.qKeyEvent,qClickOutside:l.qClickOutside,qAnchorHandled:l.qAnchorHandled,qClonedBy:l.qClonedBy===void 0?[e.uid]:l.qClonedBy.concat(e.uid)}),e.initialEvent={target:l.target,event:h}}Me(l)}const{left:b,top:c}=fe(l);e.event={x:b,y:c,time:Date.now(),mouse:m===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:b,lastY:c}},move(l){if(e.event===void 0)return;const m=fe(l),b=m.left-e.event.x,c=m.top-e.event.y;if(b===0&&c===0)return;e.lastEvt=l;const h=e.event.mouse===!0,M=()=>{a(l,h);let _;v.preserveCursor!==!0&&v.preservecursor!==!0&&(_=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),h===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Pt(),e.styleCleanup=t=>{if(e.styleCleanup=void 0,_!==void 0&&(document.documentElement.style.cursor=_),document.body.classList.remove("non-selectable"),h===!0){const p=()=>{document.body.classList.remove("no-pointer-events--children")};t!==void 0?setTimeout(()=>{p(),t()},50):p()}else t!==void 0&&t()}};if(e.event.detected===!0){e.event.isFirst!==!0&&a(l,e.event.mouse);const{payload:_,synthetic:t}=Re(l,e,!1);_!==void 0&&(e.handler(_)===!1?e.end(l):(e.styleCleanup===void 0&&e.event.isFirst===!0&&M(),e.event.lastX=_.position.left,e.event.lastY=_.position.top,e.event.lastDir=t===!0?void 0:_.direction,e.event.isFirst=!1));return}if(e.direction.all===!0||h===!0&&(e.modifiers.mouseAllDir===!0||e.modifiers.mousealldir===!0)){M(),e.event.detected=!0,e.move(l);return}const C=Math.abs(b),f=Math.abs(c);C!==f&&(e.direction.horizontal===!0&&C>f||e.direction.vertical===!0&&C<f||e.direction.up===!0&&C<f&&c<0||e.direction.down===!0&&C<f&&c>0||e.direction.left===!0&&C>f&&b<0||e.direction.right===!0&&C>f&&b>0?(e.event.detected=!0,e.move(l)):e.end(l,!0))},end(l,m){if(e.event!==void 0){if($e(e,"temp"),ue.is.firefox===!0&&ke(r,!1),m===!0)e.styleCleanup!==void 0&&e.styleCleanup(),e.event.detected!==!0&&e.initialEvent!==void 0&&e.initialEvent.target.dispatchEvent(e.initialEvent.event);else if(e.event.detected===!0){e.event.isFirst===!0&&e.handler(Re(l===void 0?e.lastEvt:l,e).payload);const{payload:b}=Re(l===void 0?e.lastEvt:l,e,!0),c=()=>{e.handler(b)};e.styleCleanup!==void 0?e.styleCleanup(c):c()}e.event=void 0,e.initialEvent=void 0,e.lastEvt=void 0}}};if(r.__qtouchpan=e,v.mouse===!0){const l=v.mouseCapture===!0||v.mousecapture===!0?"Capture":"";de(e,"main",[[r,"mousedown","mouseStart",`passive${l}`]])}ue.has.touch===!0&&de(e,"main",[[r,"touchstart","touchStart",`passive${v.capture===!0?"Capture":""}`],[r,"touchmove","noop","notPassiveCapture"]])},updated(r,y){const v=r.__qtouchpan;v!==void 0&&(y.oldValue!==y.value&&(typeof value!="function"&&v.end(),v.handler=y.value),v.direction=De(y.modifiers))},beforeUnmount(r){const y=r.__qtouchpan;y!==void 0&&(y.event!==void 0&&y.end(),$e(y,"main"),$e(y,"temp"),ue.is.firefox===!0&&ke(r,!1),y.styleCleanup!==void 0&&y.styleCleanup(),delete r.__qtouchpan)}});const je="q-slider__marker-labels",Dt=r=>({value:r}),Ot=({marker:r})=>Q("div",{key:r.value,style:r.style,class:r.classes},r.label),Ze=[34,37,40,33,39,38],jt={...gt,...Et,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:r=>r>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},Qt=["pan","update:modelValue","change"];function Wt({updateValue:r,updatePosition:y,getDragging:v,formAttrs:a}){const{props:e,emit:l,slots:m,proxy:{$q:b}}=Ke(),c=pt(e,b),h=Tt(a),M=$(!1),C=$(!1),f=$(!1),_=$(!1),t=d(()=>e.vertical===!0?"--v":"--h"),p=d(()=>"-"+(e.switchLabelSide===!0?"switched":"standard")),u=d(()=>e.vertical===!0?e.reverse===!0:e.reverse!==(b.lang.rtl===!0)),w=d(()=>isNaN(e.innerMin)===!0||e.innerMin<e.min?e.min:e.innerMin),V=d(()=>isNaN(e.innerMax)===!0||e.innerMax>e.max?e.max:e.innerMax),F=d(()=>e.disable!==!0&&e.readonly!==!0&&w.value<V.value),D=d(()=>{if(e.step===0)return x=>x;const n=(String(e.step).trim().split(".")[1]||"").length;return x=>parseFloat(x.toFixed(n))}),se=d(()=>e.step===0?1:e.step),ne=d(()=>F.value===!0?e.tabindex||0:-1),Z=d(()=>e.max-e.min),le=d(()=>V.value-w.value),X=d(()=>Fe(w.value)),J=d(()=>Fe(V.value)),Y=d(()=>e.vertical===!0?u.value===!0?"bottom":"top":u.value===!0?"right":"left"),R=d(()=>e.vertical===!0?"height":"width"),k=d(()=>e.vertical===!0?"width":"height"),I=d(()=>e.vertical===!0?"vertical":"horizontal"),q=d(()=>{const n={role:"slider","aria-valuemin":w.value,"aria-valuemax":V.value,"aria-orientation":I.value,"data-step":e.step};return e.disable===!0?n["aria-disabled"]="true":e.readonly===!0&&(n["aria-readonly"]="true"),n}),j=d(()=>`q-slider q-slider${t.value} q-slider--${M.value===!0?"":"in"}active inline no-wrap `+(e.vertical===!0?"row":"column")+(e.disable===!0?" disabled":" q-slider--enabled"+(F.value===!0?" q-slider--editable":""))+(f.value==="both"?" q-slider--focus":"")+(e.label||e.labelAlways===!0?" q-slider--label":"")+(e.labelAlways===!0?" q-slider--label-always":"")+(c.value===!0?" q-slider--dark":"")+(e.dense===!0?" q-slider--dense q-slider--dense"+t.value:""));function P(n){const x="q-slider__"+n;return`${x} ${x}${t.value} ${x}${t.value}${p.value}`}function E(n){const x="q-slider__"+n;return`${x} ${x}${t.value}`}const K=d(()=>{const n=e.selectionColor||e.color;return"q-slider__selection absolute"+(n!==void 0?` text-${n}`:"")}),oe=d(()=>E("markers")+" absolute overflow-hidden"),ge=d(()=>E("track-container")),ye=d(()=>P("pin")),he=d(()=>P("label")),xe=d(()=>P("text-container")),ce=d(()=>P("marker-labels-container")+(e.markerLabelsClass!==void 0?` ${e.markerLabelsClass}`:"")),s=d(()=>"q-slider__track relative-position no-outline"+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),i=d(()=>{const n={[k.value]:e.trackSize};return e.trackImg!==void 0&&(n.backgroundImage=`url(${e.trackImg}) !important`),n}),o=d(()=>"q-slider__inner absolute"+(e.innerTrackColor!==void 0?` bg-${e.innerTrackColor}`:"")),g=d(()=>{const n=J.value-X.value,x={[Y.value]:`${100*X.value}%`,[R.value]:n===0?"2px":`${100*n}%`};return e.innerTrackImg!==void 0&&(x.backgroundImage=`url(${e.innerTrackImg}) !important`),x});function qe(n){const{min:x,max:L,step:T}=e;let O=x+n*(L-x);if(T>0){const ee=(O-w.value)%T;O+=(Math.abs(ee)>=T/2?(ee<0?-1:1)*T:0)-ee}return O=D.value(O),U(O,w.value,V.value)}function Fe(n){return Z.value===0?0:(n-e.min)/Z.value}function Je(n,x){const L=fe(n),T=e.vertical===!0?U((L.top-x.top)/x.height,0,1):U((L.left-x.left)/x.width,0,1);return U(u.value===!0?1-T:T,X.value,J.value)}const Pe=d(()=>bt(e.markers)===!0?e.markers:se.value),Ee=d(()=>{const n=[],x=Pe.value,L=e.max;let T=e.min;do n.push(T),T+=x;while(T<L);return n.push(L),n}),Te=d(()=>{const n=` ${je}${t.value}-`;return je+`${n}${e.switchMarkerLabelsSide===!0?"switched":"standard"}${n}${u.value===!0?"rtl":"ltr"}`}),Ce=d(()=>e.markerLabels===!1?null:tt(e.markerLabels).map((n,x)=>({index:x,value:n.value,label:n.label||n.value,classes:Te.value+(n.classes!==void 0?" "+n.classes:""),style:{...Ie(n.value),...n.style||{}}}))),Ve=d(()=>({markerList:Ce.value,markerMap:lt.value,classes:Te.value,getStyle:Ie})),et=d(()=>{const n=le.value===0?"2px":100*Pe.value/le.value;return{...g.value,backgroundSize:e.vertical===!0?`2px ${n}%`:`${n}% 2px`}});function tt(n){if(n===!1)return null;if(n===!0)return Ee.value.map(Dt);if(typeof n=="function")return Ee.value.map(L=>{const T=n(L);return Ae(T)===!0?{...T,value:L}:{value:L,label:T}});const x=({value:L})=>L>=e.min&&L<=e.max;return Array.isArray(n)===!0?n.map(L=>Ae(L)===!0?L:{value:L}).filter(x):Object.keys(n).map(L=>{const T=n[L],O=Number(L);return Ae(T)===!0?{...T,value:O}:{value:O,label:T}}).filter(x)}function Ie(n){return{[Y.value]:`${100*(n-e.min)/Z.value}%`}}const lt=d(()=>{if(e.markerLabels===!1)return null;const n={};return Ce.value.forEach(x=>{n[x.value]=x}),n});function at(){if(m["marker-label-group"]!==void 0)return m["marker-label-group"](Ve.value);const n=m["marker-label"]||Ot;return Ce.value.map(x=>n({marker:x,...Ve.value}))}const it=d(()=>[[Nt,rt,void 0,{[I.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function rt(n){n.isFinal===!0?(_.value!==void 0&&(y(n.evt),n.touch===!0&&r(!0),_.value=void 0,l("pan","end")),M.value=!1,f.value=!1):n.isFirst===!0?(_.value=v(n.evt),y(n.evt),r(),M.value=!0,l("pan","start")):(y(n.evt),r())}function Be(){f.value=!1}function st(n){y(n,v(n)),r(),C.value=!0,M.value=!0,document.addEventListener("mouseup",we,!0)}function we(){C.value=!1,M.value=!1,r(!0),Be(),document.removeEventListener("mouseup",we,!0)}function nt(n){y(n,v(n)),r(!0)}function ot(n){Ze.includes(n.keyCode)&&r(!0)}function ut(n){if(e.vertical===!0)return null;const x=b.lang.rtl!==e.reverse?1-n:n;return{transform:`translateX(calc(${2*x-1} * ${e.thumbSize} / 2 + ${50-100*x}%))`}}function ct(n){const x=d(()=>C.value===!1&&(f.value===n.focusValue||f.value==="both")?" q-slider--focus":""),L=d(()=>`q-slider__thumb q-slider__thumb${t.value} q-slider__thumb${t.value}-${u.value===!0?"rtl":"ltr"} absolute non-selectable`+x.value+(n.thumbColor.value!==void 0?` text-${n.thumbColor.value}`:"")),T=d(()=>({width:e.thumbSize,height:e.thumbSize,[Y.value]:`${100*n.ratio.value}%`,zIndex:f.value===n.focusValue?2:void 0})),O=d(()=>n.labelColor.value!==void 0?` text-${n.labelColor.value}`:""),ee=d(()=>ut(n.ratio.value)),ze=d(()=>"q-slider__text"+(n.labelTextColor.value!==void 0?` text-${n.labelTextColor.value}`:""));return()=>{const Se=[Q("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[Q("path",{d:e.thumbPath})]),Q("div",{class:"q-slider__focus-ring fit"})];return(e.label===!0||e.labelAlways===!0)&&(Se.push(Q("div",{class:ye.value+" absolute fit no-pointer-events"+O.value},[Q("div",{class:he.value,style:{minWidth:e.thumbSize}},[Q("div",{class:xe.value,style:ee.value},[Q("span",{class:ze.value},n.label.value)])])])),e.name!==void 0&&e.disable!==!0&&h(Se,"push")),Q("div",{class:L.value,style:T.value,...n.getNodeData()},Se)}}function dt(n,x,L,T){const O=[];e.innerTrackColor!=="transparent"&&O.push(Q("div",{key:"inner",class:o.value,style:g.value})),e.selectionColor!=="transparent"&&O.push(Q("div",{key:"selection",class:K.value,style:n.value})),e.markers!==!1&&O.push(Q("div",{key:"marker",class:oe.value,style:et.value})),T(O);const ee=[yt("div",{key:"trackC",class:ge.value,tabindex:x.value,...L.value},[Q("div",{class:s.value,style:i.value},O)],"slide",F.value,()=>it.value)];if(e.markerLabels!==!1){const ze=e.switchMarkerLabelsSide===!0?"unshift":"push";ee[ze](Q("div",{key:"markerL",class:ce.value},at()))}return ee}return We(()=>{document.removeEventListener("mouseup",we,!0)}),{state:{active:M,focus:f,preventFocus:C,dragging:_,editable:F,classes:j,tabindex:ne,attributes:q,roundValueFn:D,keyStep:se,trackLen:Z,innerMin:w,innerMinRatio:X,innerMax:V,innerMaxRatio:J,positionProp:Y,sizeProp:R,isReversed:u},methods:{onActivate:st,onMobileClick:nt,onBlur:Be,onKeyup:ot,getContent:dt,getThumbRenderFn:ct,convertRatioToModel:qe,convertModelToRatio:Fe,getDraggingRatio:Je}}}const te={MIN:0,RANGE:1,MAX:2};var Kt=ht({name:"QRange",props:{...jt,modelValue:{type:Object,default:()=>({min:null,max:null}),validator:r=>"min"in r&&"max"in r},dragRange:Boolean,dragOnlyRange:Boolean,leftLabelColor:String,leftLabelTextColor:String,rightLabelColor:String,rightLabelTextColor:String,leftLabelValue:[String,Number],rightLabelValue:[String,Number],leftThumbColor:String,rightThumbColor:String},emits:Qt,setup(r,{emit:y}){const{proxy:{$q:v}}=Ke(),{state:a,methods:e}=Wt({updateValue:le,updatePosition:J,getDragging:X,formAttrs:d(()=>({type:"hidden",name:r.name,value:`${r.modelValue.min}|${r.modelValue.max}`}))}),l=$(null),m=$(0),b=$(0),c=$({min:0,max:0});function h(){c.value.min=r.modelValue.min===null?a.innerMin.value:U(r.modelValue.min,a.innerMin.value,a.innerMax.value),c.value.max=r.modelValue.max===null?a.innerMax.value:U(r.modelValue.max,a.innerMin.value,a.innerMax.value)}me(()=>`${r.modelValue.min}|${r.modelValue.max}|${a.innerMin.value}|${a.innerMax.value}`,h),h();const M=d(()=>e.convertModelToRatio(c.value.min)),C=d(()=>e.convertModelToRatio(c.value.max)),f=d(()=>a.active.value===!0?m.value:M.value),_=d(()=>a.active.value===!0?b.value:C.value),t=d(()=>{const R={[a.positionProp.value]:`${100*f.value}%`,[a.sizeProp.value]:`${100*(_.value-f.value)}%`};return r.selectionImg!==void 0&&(R.backgroundImage=`url(${r.selectionImg}) !important`),R}),p=d(()=>{if(a.editable.value!==!0)return{};if(v.platform.is.mobile===!0)return{onClick:e.onMobileClick};const R={onMousedown:e.onActivate};return(r.dragRange===!0||r.dragOnlyRange===!0)&&Object.assign(R,{onFocus:()=>{a.focus.value="both"},onBlur:e.onBlur,onKeydown:Y,onKeyup:e.onKeyup}),R});function u(R){return v.platform.is.mobile!==!0&&a.editable.value===!0&&r.dragOnlyRange!==!0?{onFocus:()=>{a.focus.value=R},onBlur:e.onBlur,onKeydown:Y,onKeyup:e.onKeyup}:{}}const w=d(()=>r.dragOnlyRange!==!0?a.tabindex.value:null),V=d(()=>v.platform.is.mobile!==!0&&(r.dragRange||r.dragOnlyRange===!0)?a.tabindex.value:null),F=$(null),D=d(()=>u("min")),se=e.getThumbRenderFn({focusValue:"min",getNodeData:()=>({ref:F,key:"tmin",...D.value,tabindex:w.value}),ratio:f,label:d(()=>r.leftLabelValue!==void 0?r.leftLabelValue:c.value.min),thumbColor:d(()=>r.leftThumbColor||r.thumbColor||r.color),labelColor:d(()=>r.leftLabelColor||r.labelColor),labelTextColor:d(()=>r.leftLabelTextColor||r.labelTextColor)}),ne=d(()=>u("max")),Z=e.getThumbRenderFn({focusValue:"max",getNodeData:()=>({...ne.value,key:"tmax",tabindex:w.value}),ratio:_,label:d(()=>r.rightLabelValue!==void 0?r.rightLabelValue:c.value.max),thumbColor:d(()=>r.rightThumbColor||r.thumbColor||r.color),labelColor:d(()=>r.rightLabelColor||r.labelColor),labelTextColor:d(()=>r.rightLabelTextColor||r.labelTextColor)});function le(R){(c.value.min!==r.modelValue.min||c.value.max!==r.modelValue.max)&&y("update:modelValue",{...c.value}),R===!0&&y("change",{...c.value})}function X(R){const{left:k,top:I,width:q,height:j}=l.value.getBoundingClientRect(),P=r.dragOnlyRange===!0?0:r.vertical===!0?F.value.offsetHeight/(2*j):F.value.offsetWidth/(2*q),E={left:k,top:I,width:q,height:j,valueMin:c.value.min,valueMax:c.value.max,ratioMin:M.value,ratioMax:C.value},K=e.getDraggingRatio(R,E);return r.dragOnlyRange!==!0&&K<E.ratioMin+P?E.type=te.MIN:r.dragOnlyRange===!0||K<E.ratioMax-P?r.dragRange===!0||r.dragOnlyRange===!0?(E.type=te.RANGE,Object.assign(E,{offsetRatio:K,offsetModel:e.convertRatioToModel(K),rangeValue:E.valueMax-E.valueMin,rangeRatio:E.ratioMax-E.ratioMin})):E.type=E.ratioMax-K<K-E.ratioMin?te.MAX:te.MIN:E.type=te.MAX,E}function J(R,k=a.dragging.value){let I;const q=e.getDraggingRatio(R,k),j=e.convertRatioToModel(q);switch(k.type){case te.MIN:q<=k.ratioMax?(I={minR:q,maxR:k.ratioMax,min:j,max:k.valueMax},a.focus.value="min"):(I={minR:k.ratioMax,maxR:q,min:k.valueMax,max:j},a.focus.value="max");break;case te.MAX:q>=k.ratioMin?(I={minR:k.ratioMin,maxR:q,min:k.valueMin,max:j},a.focus.value="max"):(I={minR:q,maxR:k.ratioMin,min:j,max:k.valueMin},a.focus.value="min");break;case te.RANGE:const P=q-k.offsetRatio,E=U(k.ratioMin+P,a.innerMinRatio.value,a.innerMaxRatio.value-k.rangeRatio),K=j-k.offsetModel,oe=U(k.valueMin+K,a.innerMin.value,a.innerMax.value-k.rangeValue);I={minR:E,maxR:E+k.rangeRatio,min:a.roundValueFn.value(oe),max:a.roundValueFn.value(oe+k.rangeValue)},a.focus.value="both";break}c.value=c.value.min===null||c.value.max===null?{min:I.min||r.min,max:I.max||r.max}:{min:I.min,max:I.max},r.snap!==!0||r.step===0?(m.value=I.minR,b.value=I.maxR):(m.value=e.convertModelToRatio(c.value.min),b.value=e.convertModelToRatio(c.value.max))}function Y(R){if(Ze.includes(R.keyCode)===!1)return;Qe(R);const k=([34,33].includes(R.keyCode)?10:1)*a.keyStep.value,I=([34,37,40].includes(R.keyCode)?-1:1)*(a.isReversed.value===!0?-1:1)*(r.vertical===!0?-1:1)*k;if(a.focus.value==="both"){const q=c.value.max-c.value.min,j=U(a.roundValueFn.value(c.value.min+I),a.innerMin.value,a.innerMax.value-q);c.value={min:j,max:a.roundValueFn.value(j+q)}}else{if(a.focus.value===!1)return;{const q=a.focus.value;c.value={...c.value,[q]:U(a.roundValueFn.value(c.value[q]+I),q==="min"?a.innerMin.value:c.value.min,q==="max"?a.innerMax.value:c.value.max)}}}le()}return()=>{const R=e.getContent(t,V,p,k=>{k.push(se(),Z())});return Q("div",{ref:l,class:"q-range "+a.classes.value+(r.modelValue.min===null||r.modelValue.max===null?" q-slider--no-value":""),...a.attributes.value,"aria-valuenow":r.modelValue.min+"|"+r.modelValue.max},R)}}});const Ut={class:"flex-1 pb-safe w-[90vw]"},Xt={class:"text-h6 mb-4 font-bold flex items-center justify-between"},Yt={class:"flex items-center gap-4"},Gt={class:"mb-6"},Ht={class:"grid grid-cols-[repeat(auto-fill,minmax(100px,1fr))] gap-2 w-full"},Zt={class:"mb-6"},Jt={class:"grid grid-cols-[repeat(auto-fill,minmax(80px,1fr))] gap-2 w-full"},el={class:"mb-6"},tl={class:"flex justify-start gap-5 items-center mb-2 w-full"},ll={class:"px-2"},al={__name:"ProductFilters",props:{brands:{type:Array,required:!0},colors:{type:Array,required:!0}},emits:["update:filters","apply-filters","clear-product-filters"],setup(r,{emit:y}){const v=y,a=pe(),e=_e(),l=$({brand_id:[],color_id:[],price_min:null,price_max:null,sort_by:null,is_available:null,letter_size_id:null,number_size_id:null,waist_size_id:null}),m=$({brand_id:[],color_id:[],price_min:null,price_max:null,sort_by:null,is_available:null,letter_size_id:null,number_size_id:null,waist_size_id:null}),b=$({min:0,max:1e3});d({get:()=>({min:a.activeFilters.price_min||0,max:a.activeFilters.price_max||1e3}),set:t=>{a.updateMultipleFilters({price_min:t.min||null,price_max:t.max||null})}}),be(()=>{a.activeFilters&&(a.activeFilters.brand_id&&(l.value.brand_id=[...a.activeFilters.brand_id],m.value.brand_id=[...a.activeFilters.brand_id]),a.activeFilters.color_id&&(l.value.color_id=[...a.activeFilters.color_id],m.value.color_id=[...a.activeFilters.color_id]),(a.activeFilters.price_min||a.activeFilters.price_max)&&(l.value.price_min=a.activeFilters.price_min,l.value.price_max=a.activeFilters.price_max,m.value.price_min=a.activeFilters.price_min,m.value.price_max=a.activeFilters.price_max,b.value={min:a.activeFilters.price_min||0,max:a.activeFilters.price_max||1e3}),console.log("ProductFilters initialized with active filters:",a.activeFilters))});const c=t=>{console.log("toggleBrand called with brandId:",t);const p=l.value.brand_id.indexOf(t);p===-1?(console.log("Adding brand ID to filters:",t),l.value.brand_id.push(t)):(console.log("Removing brand ID from filters:",t),l.value.brand_id.splice(p,1)),console.log("Updated brand_id filters:",l.value.brand_id),M()},h=t=>{const p=l.value.color_id.indexOf(t);p===-1?l.value.color_id.push(t):l.value.color_id.splice(p,1),M()},M=()=>{v("update:filters",{...l.value}),m.value={...m.value,...l.value},a.updateMultipleFilters(l.value);const t={...l.value};t.brand_id&&t.brand_id.length>0&&console.log("Applying brand filter with IDs:",t.brand_id),e.setFilters(t),e.fetchProducts({forceRefresh:!0})},C=()=>{l.value={brand_id:[],color_id:[],price_min:null,price_max:null,sort_by:null,is_available:null,letter_size_id:null,number_size_id:null,waist_size_id:null},b.value={min:0,max:1e3},M(),v("clear-product-filters")},f=t=>{t=t.replace("#","");const p=parseInt(t.substr(0,2),16),u=parseInt(t.substr(2,2),16),w=parseInt(t.substr(4,2),16);return(.299*p+.587*u+.114*w)/255>.5},_=()=>{l.value.price_min=b.value.min||null,l.value.price_max=b.value.max||null,a.updateMultipleFilters({price_min:b.value.min||null,price_max:b.value.max||null}),e.setFilters({price_min:b.value.min||null,price_max:b.value.max||null}),m.value={...m.value,price_min:b.value.min||null,price_max:b.value.max||null},console.log("Applied price range:",{min:b.value.min,max:b.value.max}),e.fetchProducts(),v("update:filters",{...l.value})};return(t,p)=>(z(),A("div",Ut,[S("div",Xt,[p[1]||(p[1]=S("div",null,"Filters",-1)),S("div",Yt,[S("span",{class:"text-primary cursor-pointer text-sm",onClick:C},"Clear"),Ue(B(W,{icon:"close",flat:"",round:"",dense:""},null,512),[[Xe]])])]),S("div",Gt,[p[2]||(p[2]=S("div",{class:"text-subtitle1 font-bold mb-2 w-full"},"Brands",-1)),S("div",Ht,[(z(!0),A(G,null,H(r.brands,u=>(z(),ie(W,{key:u.id,label:u.name,color:l.value.brand_id.includes(u.id)?"primary":"white","text-color":l.value.brand_id.includes(u.id)?"white":"black",class:re(["w-full h-10 rounded text-sm hover:opacity-90 transition-opacity border border-gray-300",{"border-primary bg-accent text-white":l.value.brand_id.includes(u.id)}]),flat:"",dense:"","no-caps":"",onClick:w=>c(u.id)},null,8,["label","color","text-color","class","onClick"]))),128))])]),S("div",Zt,[p[3]||(p[3]=S("div",{class:"text-subtitle1 font-bold mb-2 w-full"},"Colors",-1)),S("div",Jt,[(z(!0),A(G,null,H(r.colors,u=>(z(),ie(W,{key:u.id,style:xt({backgroundColor:l.value.color_id.includes(u.id)?u.hex:"white"}),"text-color":l.value.color_id.includes(u.id)?f(u.hex)?"black":"white":"black",class:re(["w-full h-10 rounded text-sm hover:opacity-90 transition-opacity border border-gray-300",{"border-primary bg-accent text-white":l.value.color_id.includes(u.id)}]),flat:"",dense:"","no-caps":"",onClick:w=>h(u.id)},{default:ve(()=>[Ye(Ge(u.name),1)]),_:2},1032,["style","text-color","class","onClick"]))),128))])]),S("div",el,[S("div",tl,[p[4]||(p[4]=S("div",{class:"text-subtitle1 font-bold"},"Price Range",-1)),B(W,{label:"Apply Range",color:"primary",flat:"",dense:"","no-caps":"",class:"text-xs bg-primary text-white px-2 py-1",onClick:_})]),S("div",ll,[B(Kt,{modelValue:b.value,"onUpdate:modelValue":p[0]||(p[0]=u=>b.value=u),min:0,max:1e3,step:10,"label-always":"","switch-label-side":"",color:"primary",class:"mb-4"},null,8,["modelValue"])])])]))}},il={class:"flex-1 overflow-y-auto pb-safe w-full"},rl={class:"text-h6 mb-4 font-bold flex items-center justify-between"},sl={class:"flex items-center gap-4"},nl={key:0,class:"mb-6"},ol={class:"grid grid-cols-[repeat(auto-fill,minmax(50px,1fr))] gap-2 w-full"},ul={key:1,class:"mb-6"},cl={class:"grid grid-cols-[repeat(auto-fill,minmax(50px,1fr))] gap-2 w-full"},dl={key:2,class:"mb-6"},vl={class:"grid grid-cols-[repeat(auto-fill,minmax(50px,1fr))] gap-2 w-full"},ml={__name:"SizeFilters",props:{selectedSizes:{type:Array,default:()=>[]}},emits:["apply-filters","update:selected-sizes","clear-size-filters"],setup(r,{emit:y}){const v=r,a=He(),e=pe(),l=_e(),m=y,b=$([...v.selectedSizes]),c=(C,f)=>{const _=`${f}_size_id`,t=e.activeFilters[_];let p=!1;Array.isArray(t)?p=t.includes(C.id):t!=null&&(p=t===C.id);const u=Array.isArray(v.selectedSizes)&&v.selectedSizes.some(w=>w.id===C.id&&w.type===f);return p||u},h=(C,f)=>{const _=`${f}_size_id`,t=e.activeFilters[_];let p=[];Array.isArray(t)?p=[...t]:t!=null&&(p=[t]);const u=p.includes(C.id);u?p=p.filter(F=>F!==C.id):p.push(C.id),e.updateFilter(_,p);let w=[...v.selectedSizes];u?w=w.filter(F=>!(F.id===C.id&&F.type===f)):w.some(F=>F.id===C.id&&F.type===f)||w.push({...C,type:f}),m("update:selected-sizes",w);const V={};if(f==="letter")V.letter_size_id=p;else{const F=e.activeFilters.letter_size_id;V.letter_size_id=Array.isArray(F)?F:F!=null?[F]:[]}if(f==="number")V.number_size_id=p;else{const F=e.activeFilters.number_size_id;V.number_size_id=Array.isArray(F)?F:F!=null?[F]:[]}if(f==="waist")V.waist_size_id=p;else{const F=e.activeFilters.waist_size_id;V.waist_size_id=Array.isArray(F)?F:F!=null?[F]:[]}l.setFilters(V),l.fetchProducts(),m("apply-filters")},M=()=>{["letter_size_id","number_size_id","waist_size_id"].forEach(_=>{e.updateFilter(_,[])}),b.value=[],m("update:selected-sizes",[]);const f={letter_size_id:[],number_size_id:[],waist_size_id:[]};l.setFilters(f),l.fetchProducts(),m("apply-filters"),m("clear-size-filters")};return be(()=>{const C=[],f=(_,t,p)=>{const u=e.activeFilters[t],w=[];Array.isArray(u)?w.push(...u):u!=null&&w.push(u),w.forEach(V=>{const F=p.find(D=>D.id===V);F&&C.push({...F,type:_})})};f("letter","letter_size_id",a.getLetterSizes),f("number","number_size_id",a.getNumberSizes),f("waist","waist_size_id",a.getWaistSizes),C.length>0&&m("update:selected-sizes",C)}),(C,f)=>{var _,t,p;return z(),A("div",il,[S("div",rl,[f[0]||(f[0]=S("div",null,"Select Size",-1)),S("div",sl,[S("span",{class:"text-primary cursor-pointer text-sm",onClick:M},"Clear"),Ue(B(W,{icon:"close",flat:"",round:"",dense:""},null,512),[[Xe]])])]),(_=N(a).getWaistSizes)!=null&&_.length?(z(),A("div",nl,[f[1]||(f[1]=S("div",{class:"text-subtitle1 font-medium mb-2 w-full font-bold"},"Waist Size",-1)),S("div",ol,[(z(!0),A(G,null,H(N(a).getWaistSizes,u=>(z(),ie(W,{key:u.slug,label:u.display_name,color:c(u,"waist")?"primary":"white","text-color":c(u,"waist")?"white":"black",class:re(["w-full h-10 rounded text-sm hover:opacity-90 transition-opacity border",c(u,"waist")?"border-primary bg-primary":"border-gray-300"]),flat:"",dense:"","no-caps":"",onClick:w=>h(u,"waist")},null,8,["label","color","text-color","class","onClick"]))),128))])])):ae("",!0),(t=N(a).getLetterSizes)!=null&&t.length?(z(),A("div",ul,[f[2]||(f[2]=S("div",{class:"text-subtitle1 font-medium mb-2 w-full font-bold"},"Letter Size",-1)),S("div",cl,[(z(!0),A(G,null,H(N(a).getLetterSizes,u=>(z(),ie(W,{key:u.slug,label:u.name,color:c(u,"letter")?"primary":"white","text-color":c(u,"letter")?"white":"black",class:re(["w-full h-10 rounded text-sm hover:opacity-90 transition-opacity border",c(u,"letter")?"border-primary bg-primary":"border-gray-300"]),flat:"",dense:"","no-caps":"",onClick:w=>h(u,"letter")},null,8,["label","color","text-color","class","onClick"]))),128))])])):ae("",!0),(p=N(a).getNumberSizes)!=null&&p.length?(z(),A("div",dl,[f[3]||(f[3]=S("div",{class:"text-subtitle1 font-medium mb-2 w-full font-bold"},"Number Size",-1)),S("div",vl,[(z(!0),A(G,null,H(N(a).getNumberSizes,u=>(z(),ie(W,{key:u.slug,label:u.name,color:c(u,"number")?"primary":"white","text-color":c(u,"number")?"white":"black",class:re(["w-full h-10 rounded text-sm hover:opacity-90 transition-opacity border",c(u,"number")?"border-primary bg-primary":"border-gray-300"]),flat:"",dense:"","no-caps":"",onClick:w=>h(u,"number")},null,8,["label","color","text-color","class","onClick"]))),128))])])):ae("",!0)])}}};const fl={class:"product-skeleton-grid"},_l={class:"flex-container px-4 py-4"},pl={__name:"ProductSkeletonGrid",props:{count:{type:Number,default:12},imageHeight:{type:String,default:"220px"}},setup(r){return(y,v)=>(z(),A("div",fl,[S("div",_l,[(z(!0),A(G,null,H(r.count,a=>(z(),A("div",{key:a,class:"flex-item"},[B(At,{"image-height":r.imageHeight},null,8,["image-height"])]))),128))])]))}};var bl=Le(pl,[["__scopeId","data-v-ad5dcbd8"]]);const gl={class:"products-page"},yl={class:"filter-bar top-0 z-40 bg-white border-b border-gray-100 px-4 py-2"},hl={class:"relative"},xl={class:"flex overflow-x-auto py-2 gap-2 scrollbar-hide"},Fl={key:0,class:"flex-container px-4 py-4"},Cl={key:1},wl={key:2,class:"text-center py-10 px-4"},zl={key:3,class:"text-center py-4"},Sl={key:4,class:"text-center py-2"},kl={key:5,class:"text-center py-4"},Ml={class:"flex flex-col max-h-[80vh] p-4 space-y-4 overflow-hidden"},$l={class:"flex flex-col w-full"},Al={key:0,class:"w-full"},Rl={key:1,class:"w-full"},Ll={__name:"ProductsPage",setup(r){const y=Ft(),v=Ct(),a=_e(),e=He(),l=pe(),m=Rt(),b=wt(),c=$(!1),h=$(null),M=$(!1),C=$(50),f=$(!1),_=$([]),t=$({brand_id:[],category_id:[],color_id:[],price_min:null,price_max:null,sort_by:null,is_available:null,letter_size_id:null,number_size_id:null,waist_size_id:null}),p=()=>{t.value={...t.value,...l.getActiveFilters,category_id:l.activeFilters.category_id||[],brand_id:l.activeFilters.brand_id||[],color_id:l.activeFilters.color_id||[]}},u=$(1),w=$(1),V=$(20),F=$(0),D=$(""),se=$("");me(()=>l.activeFilters.search,s=>{D.value=s||""});const ne=s=>{h.value=s,c.value=!0},Z=()=>new Promise((s,i)=>{if(!navigator.geolocation){i(new Error("Geolocation is not supported by your browser"));return}navigator.geolocation.getCurrentPosition(s,i,{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}),le=s=>{t.value.category_id||(t.value.category_id=[]);const i=t.value.category_id.indexOf(s);i===-1?t.value.category_id.push(s):t.value.category_id.splice(i,1),l.updateFilter("category_id",t.value.category_id),a.setFilters(l.getActiveFilters),P()},X=(s,i)=>{switch(t.value.category_id||(t.value.category_id=[]),s){case"category":return Array.isArray(t.value.category_id)&&t.value.category_id.includes(i);default:return!1}},J=async()=>{try{if(u.value=1,_.value.length>0){const s=_.value.map(i=>({type:i.type,id:i.id}));t.value.letter_size_id=null,t.value.number_size_id=null,t.value.waist_size_id=null,s.forEach(i=>{i.type==="letter"?t.value.letter_size_id=i.id:i.type==="number"?t.value.number_size_id=i.id:i.type==="waist"&&(t.value.waist_size_id=i.id)})}else t.value.letter_size_id=null,t.value.number_size_id=null,t.value.waist_size_id=null;Object.entries(t.value).forEach(([s,i])=>{l.updateFilter(s,i)}),a.setFilters(l.getActiveFilters),await P()}catch(s){console.error("Failed to apply filters:",s)}},Y=s=>{if(s==="search"){D.value="",l.updateFilter("search",null),a.setFilters({search:null}),P();return}if(s.startsWith("brand-")){const i=parseInt(s.split("-")[1]);t.value.brand_id=t.value.brand_id.filter(o=>o!==i),l.updateFilter("brand_id",t.value.brand_id),a.setFilters({brand_id:t.value.brand_id}),P();return}else if(s.startsWith("color-")){const i=parseInt(s.split("-")[1]);t.value.color_id=t.value.color_id.filter(o=>o!==i),l.updateFilter("color_id",t.value.color_id),a.setFilters({color_id:t.value.color_id}),P();return}else if(s==="price-range")t.value.price_min=null,t.value.price_max=null,l.updateFilter("price_min",null),l.updateFilter("price_max",null),a.setFilters({price_min:null,price_max:null}),P();else if(s.startsWith("letter_size_")){const i=parseInt(s.split("_")[2]);let o=Array.isArray(t.value.letter_size_id)?[...t.value.letter_size_id]:t.value.letter_size_id?[t.value.letter_size_id]:[];o=o.filter(g=>g!==i),l.updateFilter("letter_size_id",o),_.value=_.value.filter(g=>!(g.id===i&&g.type==="letter"))}else if(s.startsWith("number_size_")){const i=parseInt(s.split("_")[2]);let o=Array.isArray(t.value.number_size_id)?[...t.value.number_size_id]:t.value.number_size_id?[t.value.number_size_id]:[];o=o.filter(g=>g!==i),l.updateFilter("number_size_id",o),_.value=_.value.filter(g=>!(g.id===i&&g.type==="number"))}else if(s.startsWith("waist_size_")){const i=parseInt(s.split("_")[2]);let o=Array.isArray(t.value.waist_size_id)?[...t.value.waist_size_id]:t.value.waist_size_id?[t.value.waist_size_id]:[];o=o.filter(g=>g!==i),l.updateFilter("waist_size_id",o),_.value=_.value.filter(g=>!(g.id===i&&g.type==="waist"))}else s==="size"?(_.value=[],t.value.letter_size_id=null,t.value.number_size_id=null,t.value.waist_size_id=null,l.updateFilter("letter_size_id",[]),l.updateFilter("number_size_id",[]),l.updateFilter("waist_size_id",[])):(Array.isArray(t.value[s])?t.value[s]=[]:t.value[s]=null,l.updateFilter(s,t.value[s]));a.setFilters(l.getActiveFilters),P()},R=()=>{_.value=[],t.value={brand_id:[],category_id:[],color_id:[],price_min:null,price_max:null,sort_by:null,is_available:null,letter_size_id:null,number_size_id:null,waist_size_id:null},l.clearAllFilters(),D.value="",l.updateFilter("search",null),M.value=!1,a.setFilters({}),P()},k=()=>{const s={};return D.value&&(s.search=`"${D.value}"`),t.value.price_min&&t.value.price_max?s["price-range"]=`$${t.value.price_min} - $${t.value.price_max}`:t.value.price_min?s["price-range"]=`Min $${t.value.price_min}`:t.value.price_max&&(s["price-range"]=`Max $${t.value.price_max}`),t.value.brand_id&&t.value.brand_id.length>0&&t.value.brand_id.forEach(i=>{const o=e.getBrands.find(g=>g.id===i);s[`brand-${i}`]=o?o.name:i}),t.value.color_id&&t.value.color_id.length>0&&t.value.color_id.forEach(i=>{const o=e.getColors.find(g=>g.id===i);s[`color-${i}`]=o?o.name:i}),_.value.length>0&&(_.value.forEach(i=>{const o=i.name||i.display_name||i.id,g=i.type==="waist"?"Waist":"Size";s[`${i.type}_size_${i.id}`]=`${g}: ${o}`}),Array.isArray(t.value.letter_size_id)&&t.value.letter_size_id.length>0&&t.value.letter_size_id.forEach(i=>{const o=e.getSizes.find(g=>g.id===i&&g.type==="letter");if(o){const g=o.name||o.display_name||i;s[`letter_size_${i}`]=`Size: ${g}`}}),Array.isArray(t.value.number_size_id)&&t.value.number_size_id.length>0&&t.value.number_size_id.forEach(i=>{const o=e.getSizes.find(g=>g.id===i&&g.type==="number");if(o){const g=o.name||o.display_name||i;s[`number_size_${i}`]=`Size: ${g}`}}),Array.isArray(t.value.waist_size_id)&&t.value.waist_size_id.length>0&&t.value.waist_size_id.forEach(i=>{const o=e.getSizes.find(g=>g.id===i&&g.type==="waist");if(o){const g=o.name||o.display_name||i;s[`waist_size_${i}`]=`Waist: ${g}`}})),s},I=s=>{se.value=s},q=s=>{s!==D.value&&(D.value=s,l.updateFilter("search",s),a.setFilters({search:s}),P())},j=async()=>{if(u.value<w.value){f.value=!0;try{u.value++,console.log(`Loading more products - requesting page ${u.value} of ${w.value}`);const s=l.getActiveFilters;if(v.query&&v.query.category_ids){const i=v.query.category_ids.split(",").map(o=>parseInt(o));s.category_id?Array.isArray(s.category_id)&&i.forEach(o=>{s.category_id.includes(o)||s.category_id.push(o)}):s.category_id=i,l.updateFilter("category_id",s.category_id)}await P(!0)}catch(s){console.error("Error loading more products:",s)}finally{f.value=!1}}},P=async(s=!1)=>{try{s||(a.isLoading=!0,a.resetPagination());const i=l.getActiveFilters;a.setFilters(i,!s),await a.fetchProducts({page:u.value,forceRefresh:!s,append:s}),u.value=a.pagination.currentPage,w.value=a.pagination.totalPages,V.value=a.pagination.perPage,F.value=a.pagination.total||0}catch(i){throw console.error("Error fetching products:",i),i}finally{}},E=s=>{try{return m&&m.isFavorite?m.isFavorite(s.id):!1}catch(i){return console.error("Error checking favorite status:",i),!1}},K=async s=>{try{m&&m.toggleFavorite&&await m.toggleFavorite(s.id)}catch(i){console.error("Failed to toggle favorite:",i)}},oe=s=>{y.push({name:"product-details",params:{id:s.id}})},ge=s=>{console.error("Failed to load image:",s)},ye=()=>{if(!!v.query&&(t.value.category_id||(t.value.category_id=[]),v.query.category_ids)){console.log("Processing category_ids from URL:",v.query.category_ids);const s=v.query.category_ids.split(",").map(o=>parseInt(o)),i=[...new Set([...t.value.category_id,...s])];t.value.category_id=i,console.log("Updated category_id filter:",t.value.category_id)}},he=()=>{t.value={...t.value,brand_id:[],color_id:[],price_min:null,price_max:null,sort_by:null,is_available:null},Object.entries(t.value).forEach(([s,i])=>{l.updateFilter(s,i)}),a.setFilters(l.getActiveFilters),P()},xe=()=>{_.value=[],t.value={...t.value,letter_size_id:null,number_size_id:null,waist_size_id:null},l.updateFilter("letter_size_id",[]),l.updateFilter("number_size_id",[]),l.updateFilter("waist_size_id",[]),a.setFilters(l.getActiveFilters),P()};be(async()=>{try{if(p(),await e.fetchCategories(),await Promise.all([e.fetchAllBrands(),e.fetchAllColors(),e.fetchAllSizes()]),v.query){if(t.value.category_id||(t.value.category_id=[]),ye(),v.query.filter){const s=v.query.filter,i=e.categories.find(o=>o.name.toLowerCase()===s.toLowerCase());i&&t.value.category_id.push(i.id)}if(v.query.category){t.value.category_id||(t.value.category_id=[]);const s=v.query.category,i=e.categories.find(o=>o.name.toLowerCase()===s.toLowerCase());i&&t.value.category_id.push(i.id)}if(v.query.categories&&(t.value.category_id||(t.value.category_id=[]),v.query.categories.split(",").forEach(i=>{const o=e.categories.find(g=>g.name.toLowerCase()===i.toLowerCase());o&&t.value.category_id.push(o.id)})),v.query.nearby==="true"){M.value=!0;try{const s=await Z();s&&a.setFilters({latitude:s.coords.latitude,longitude:s.coords.longitude,radius:C.value})}catch(s){console.error("Failed to get location:",s)}}v.query.q&&(D.value=v.query.q,a.setFilters({search:v.query.q})),Object.entries(t.value).forEach(([s,i])=>{i!==null&&(typeof i!="object"||Array.isArray(i)&&i.length>0)&&l.updateFilter(s,i)}),a.setFilters(l.getActiveFilters)}ce(),await P(),m&&m.fetchFavorites&&await m.fetchFavorites()}catch(s){console.error("Failed to initialize products page:",s)}}),We(()=>{console.log("Leaving ProductsPage, clearing all filters"),_.value=[],t.value={brand_id:[],category_id:[],color_id:[],price_min:null,price_max:null,sort_by:null,is_available:null,letter_size_id:null,number_size_id:null,waist_size_id:null},l.clearAllFilters(),a.setFilters({})});const ce=()=>{console.group("Filter State"),console.log("Component activeFilters:",{...t.value}),console.log("FilterStore activeFilters:",{...l.activeFilters}),console.log("FilterStore getActiveFilters:",{...l.getActiveFilters}),console.groupEnd()};return me(()=>t.value,()=>{ce()},{deep:!0}),(s,i)=>(z(),A("div",gl,[S("div",yl,[S("div",hl,[B(It,{onSearch:q,onInput:I,"initial-query":D.value},null,8,["initial-query"])]),S("div",xl,[B(W,{outline:"",rounded:"",size:"sm",color:"primary",icon:"tune",label:"Filters","no-caps":"",class:"whitespace-nowrap",onClick:i[0]||(i[0]=o=>ne("filters"))}),B(W,{outline:"",rounded:"",size:"sm",color:"grey",icon:"straighten",label:"Size","no-caps":"",class:re(["whitespace-nowrap",{"bg-primary-light text-primary":_.value.length>0}]),onClick:i[1]||(i[1]=o=>ne("sizes"))},null,8,["class"]),(z(!0),A(G,null,H(N(e).categories,o=>(z(),ie(W,{key:o.id,outline:"",rounded:"",size:"sm",color:X("category",o.id)?"primary":"grey",label:o.name,"no-caps":"",class:re(["whitespace-nowrap",{"bg-primary-light":X("category",o.id)}]),onClick:g=>le(o.id)},null,8,["color","label","class","onClick"]))),128)),(z(!0),A(G,null,H(k(),(o,g)=>(z(),ie($t,{key:g,removable:"",dense:"",size:"sm",color:"primary","text-color":"white",class:"whitespace-nowrap px-4 py-3 m-0",onRemove:qe=>Y(g)},{default:ve(()=>[Ye(Ge(o),1)]),_:2},1032,["onRemove"]))),128))])]),N(a).isLoading?(z(),A("div",Cl,[B(bl,{count:12})])):(z(),A("div",Fl,[(z(!0),A(G,null,H(N(a).products,o=>(z(),A("div",{key:o.id,class:"flex-item"},[B(Lt,{product:o,"is-favorite":E(o),"is-authenticated":N(b).isAuthenticated,"fixed-width":!1,"image-height":"220px",onClick:g=>oe(o),onToggleFavorite:g=>K(o),onImageError:ge},null,8,["product","is-favorite","is-authenticated","onClick","onToggleFavorite"])]))),128))])),!N(a).isLoading&&N(a).products.length===0?(z(),A("div",wl,[B(zt,{name:"search_off",size:"4rem",color:"grey-5"}),i[5]||(i[5]=S("h3",{class:"text-xl font-medium mt-4 mb-2"},"No products found",-1)),i[6]||(i[6]=S("p",{class:"text-gray-500 mb-6"},"Try adjusting your filters or search terms",-1)),B(W,{color:"primary",label:"Clear filters",onClick:R})])):ae("",!0),!N(a).isLoading&&N(a).products.length>0&&u.value<w.value?(z(),A("div",zl,[B(W,{outline:"",color:"primary","no-caps":"",label:"View More",onClick:j,loading:f.value},null,8,["loading"])])):ae("",!0),f.value?(z(),A("div",Sl,[B(St,{color:"primary",size:"2em"}),i[7]||(i[7]=S("p",{class:"text-gray-500 text-sm mt-2"},"Loading more products...",-1))])):ae("",!0),!N(a).isLoading&&N(a).products.length>0&&u.value>=w.value?(z(),A("div",kl,i[8]||(i[8]=[S("p",{class:"text-gray-500"},"No more products to load",-1)]))):ae("",!0),B(Mt,{modelValue:c.value,"onUpdate:modelValue":i[4]||(i[4]=o=>c.value=o),position:"bottom","full-width":!0},{default:ve(()=>[B(kt,{class:"rounded-t-2xl"},{default:ve(()=>[S("div",Ml,[S("div",$l,[h.value==="sizes"?(z(),A("div",Al,[B(ml,{"selected-sizes":_.value,"onUpdate:selectedSizes":i[2]||(i[2]=o=>_.value=o),onApplyFilters:J,onClearSizeFilters:xe},null,8,["selected-sizes"])])):(z(),A("div",Rl,[B(al,{brands:N(e).getBrands,colors:N(e).getColors,sizes:N(e).getSizes,filters:t.value,"onUpdate:filters":i[3]||(i[3]=o=>t.value=o),onApplyFilters:J,onClearProductFilters:he},null,8,["brands","colors","sizes","filters"])]))])])]),_:1})]),_:1},8,["modelValue"])]))}};var Ol=Le(Ll,[["__scopeId","data-v-5b64772b"]]);export{Ol as default};
